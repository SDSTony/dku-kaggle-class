
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>데모 &#8212; 단국대 2020 캐글 뽀개기</title>
    
  <link rel="stylesheet" href="../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script kind="utterances">

    var commentsRunWhenDOMLoaded = cb => {
    if (document.readyState != 'loading') {
        cb()
    } else if (document.addEventListener) {
        document.addEventListener('DOMContentLoaded', cb)
    } else {
        document.attachEvent('onreadystatechange', function() {
        if (document.readyState == 'complete') cb()
        })
    }
}

var addUtterances = () => {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://utteranc.es/client.js";
    script.async = "async";

    script.setAttribute("repo", "kaggler-tv/dku-kaggle-class");
    script.setAttribute("issue-term", "pathname");
    script.setAttribute("theme", "github-light");
    script.setAttribute("label", "💬 comment");
    script.setAttribute("crossorigin", "anonymous");

    sections = document.querySelectorAll("div.section");
    if (sections !== null) {
        section = sections[sections.length-1];
        section.appendChild(script);
    }
}
commentsRunWhenDOMLoaded(addUtterances);
</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../_static/logo.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="데모" href="09-lightgbm-optuna.html" />
    <link rel="prev" title="9. 모델 튜닝" href="09-tuning.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">단국대 2020 캐글 뽀개기</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../main.html">
   단국대 2020년 가을학기 캐글 뽀개기 강좌
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="01-intro.html">
   1장. Intro
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02-setup.html">
   2장. Setup
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="03-pandas-intro.html">
   3장. Pandas
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="03-pandas.html">
     이론
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03-pandas-eda.html">
     실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="04-numpy-intro.html">
   4장. Numpy, 선형회귀, 로지스틱회귀
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="04-numpy.html">
     이론
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="04-numpy-lr.html">
     실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="05-numerical-features-intro.html">
   5장. 수치형변수 가공
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="05-numerical-features.html">
     실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="06-scikit-learn-intro.html">
   6장. Scikit-learn, 결정트리
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="06-scikit-learn.html">
     이론
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="06-decision-trees.html">
     실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="07-rf-lgb-intro.html">
   7장. Random Forest, GBM
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="07-rf-lgb.html">
     이론
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="07-rf.html">
     Random Forest 실습
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="07-lightgbm.html">
     LightGBM 실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="08-cv-stacking-intro.html">
   8장. Cross-Validation, Stacking
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="08-cv-stacking.html">
     이론
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="08-lr-cv.html">
     로지스틱 회귀 CV 실습
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="08-rf-cv.html">
     Random Forest CV 실습
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="08-lightgbm-cv.html">
     LightGBM CV 실습
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="08-stacking-lr.html">
     로지스틱 회귀 스태킹 실습
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="08-stacking-lgb.html">
     LightGBM 스태킹 실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="09-tuning-intro.html">
   9장. 모델 튜닝, Hyperopt, Optuna
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="09-tuning.html">
     이론
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Hyperopt 실습
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="09-lightgbm-optuna.html">
     Optuna 실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="10-pipeline-make-intro.html">
   10장. Pipeline, Make
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="10-pipeline-make.html">
     이론
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="11-categorical-features-intro.html">
   11장. 범주형변수 가공
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="11-categorical-features.html">
     실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="12-nn-intro.html">
   12장. 신경망, Keras
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="12-nn-keras.html">
     이론
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="12-nn-cv.html">
     실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="13-text-features-intro.html">
   13장. 문자열변수 가공
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="13-text-features.html">
     이론
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="13-lr-tfidf.html">
     실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="14-embeddings-intro.html">
   14장. Embedding, RNN
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="14-embeddings.html">
     이론
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="14-cnn-emb.html">
     CNN - Embeddings 실습
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="14-lstm-emb.html">
     LSTM - Embeddings 실습
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="14-lstm-glove.html">
     LSTM - GloVe 실습
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="14-attention.html">
     Attention 실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="15-transfer-learning-intro.html">
   15장. 선학습 임베딩, 전이학습
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="15-transfer-learning.html">
     이론
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="15-bert.html">
     실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="16-data-augmentation.html">
   16장. Data Augmentation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="17-cnn.html">
   17장. CNN
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="18-image-classification.html">
   18장. Image Classification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="19-post-processing.html">
   19장. 후처리, 기타팁
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/lectures/09-lightgbm-hyperopt.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/kaggler-tv/dku-kaggle-class"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/kaggler-tv/dku-kaggle-class/issues/new?title=Issue%20on%20page%20%2Flectures/09-lightgbm-hyperopt.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/kaggler-tv/dku-kaggle-class/master?urlpath=tree/lectures/09-lightgbm-hyperopt.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#import">
   라이브러리 import 및 설정
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   학습데이터 로드
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#hyperparameter-tuning">
   Hyperparameter Tuning
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#stratified-k-fold-cross-validation">
   Stratified K-Fold Cross Validation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lightgbm">
   LightGBM 모델 학습
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id3">
   피처 중요도 시각화
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id4">
   제출 파일 생성
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="id1">
<h1>데모<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<div class="section" id="import">
<h2>라이브러리 import 및 설정<a class="headerlink" href="#import" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">reload_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hyperopt</span> <span class="kn">import</span> <span class="n">STATUS_OK</span><span class="p">,</span> <span class="n">Trials</span><span class="p">,</span> <span class="n">hp</span><span class="p">,</span> <span class="n">space_eval</span><span class="p">,</span> <span class="n">tpe</span><span class="p">,</span> <span class="n">fmin</span>
<span class="kn">import</span> <span class="nn">lightgbm</span> <span class="k">as</span> <span class="nn">lgb</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">rcParams</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">StratifiedKFold</span><span class="p">,</span> <span class="n">train_test_split</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">warnings</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;fivethirtyeight&#39;</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;max_columns&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.precision&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id2">
<h2>학습데이터 로드<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/kaggler-tv/dku-kaggle-class/blob/master/notebook/03-pandas-eda.ipynb">03-pandas-eda.ipynb</a>에서 생성한 <code class="docutils literal notranslate"><span class="pre">feature.csv</span></code> 피처파일 사용</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;../data/dacon-dku&#39;</span><span class="p">)</span>
<span class="n">feature_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;../build/feature&#39;</span><span class="p">)</span>
<span class="n">val_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;../build/val&#39;</span><span class="p">)</span>
<span class="n">tst_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;../build/tst&#39;</span><span class="p">)</span>
<span class="n">sub_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;../build/sub&#39;</span><span class="p">)</span>

<span class="n">trn_file</span> <span class="o">=</span> <span class="n">data_dir</span> <span class="o">/</span> <span class="s1">&#39;train.csv&#39;</span>
<span class="n">tst_file</span> <span class="o">=</span> <span class="n">data_dir</span> <span class="o">/</span> <span class="s1">&#39;test.csv&#39;</span>
<span class="n">sample_file</span> <span class="o">=</span> <span class="n">data_dir</span> <span class="o">/</span> <span class="s1">&#39;sample_submission.csv&#39;</span>

<span class="n">target_col</span> <span class="o">=</span> <span class="s1">&#39;class&#39;</span>
<span class="n">n_fold</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_class</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">seed</span> <span class="o">=</span> <span class="mi">42</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">algo_name</span> <span class="o">=</span> <span class="s1">&#39;lgb_hyperopt&#39;</span>
<span class="n">feature_name</span> <span class="o">=</span> <span class="s1">&#39;feature&#39;</span>
<span class="n">model_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">algo_name</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">feature_name</span><span class="si">}</span><span class="s1">&#39;</span>

<span class="n">feature_file</span> <span class="o">=</span> <span class="n">feature_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">feature_name</span><span class="si">}</span><span class="s1">.csv&#39;</span>
<span class="n">p_val_file</span> <span class="o">=</span> <span class="n">val_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s1">.val.csv&#39;</span>
<span class="n">p_tst_file</span> <span class="o">=</span> <span class="n">tst_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s1">.tst.csv&#39;</span>
<span class="n">sub_file</span> <span class="o">=</span> <span class="n">sub_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s1">.csv&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">feature_file</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(400000, 20)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>z</th>
      <th>redshift</th>
      <th>dered_u</th>
      <th>dered_g</th>
      <th>dered_r</th>
      <th>dered_i</th>
      <th>dered_z</th>
      <th>nObserve</th>
      <th>airmass_u</th>
      <th>class</th>
      <th>d_dered_u</th>
      <th>d_dered_g</th>
      <th>d_dered_r</th>
      <th>d_dered_i</th>
      <th>d_dered_z</th>
      <th>d_dered_ig</th>
      <th>d_dered_zg</th>
      <th>d_dered_rz</th>
      <th>d_dered_iz</th>
      <th>d_obs_det</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>16.9396</td>
      <td>-8.1086e-05</td>
      <td>23.1243</td>
      <td>20.2578</td>
      <td>18.9551</td>
      <td>17.6321</td>
      <td>16.9089</td>
      <td>2.9444</td>
      <td>1.1898</td>
      <td>0.0</td>
      <td>-0.1397</td>
      <td>-0.0790</td>
      <td>-0.0544</td>
      <td>-0.0403</td>
      <td>-0.0307</td>
      <td>-2.6257</td>
      <td>-3.3488</td>
      <td>2.0462</td>
      <td>0.7232</td>
      <td>-15.0556</td>
    </tr>
    <tr>
      <th>1</th>
      <td>13.1689</td>
      <td>4.5061e-03</td>
      <td>14.9664</td>
      <td>14.0045</td>
      <td>13.4114</td>
      <td>13.2363</td>
      <td>13.1347</td>
      <td>0.6931</td>
      <td>1.2533</td>
      <td>1.0</td>
      <td>-0.0857</td>
      <td>-0.0574</td>
      <td>-0.0410</td>
      <td>-0.0322</td>
      <td>-0.0343</td>
      <td>-0.7683</td>
      <td>-0.8698</td>
      <td>0.2767</td>
      <td>0.1016</td>
      <td>-0.3069</td>
    </tr>
    <tr>
      <th>2</th>
      <td>15.3500</td>
      <td>4.7198e-04</td>
      <td>16.6076</td>
      <td>15.6866</td>
      <td>15.4400</td>
      <td>15.3217</td>
      <td>15.2961</td>
      <td>1.0986</td>
      <td>1.0225</td>
      <td>0.0</td>
      <td>-0.1787</td>
      <td>-0.1388</td>
      <td>-0.0963</td>
      <td>-0.0718</td>
      <td>-0.0540</td>
      <td>-0.3649</td>
      <td>-0.3905</td>
      <td>0.1440</td>
      <td>0.0257</td>
      <td>-0.9014</td>
    </tr>
    <tr>
      <th>3</th>
      <td>19.6346</td>
      <td>5.8143e-06</td>
      <td>25.3536</td>
      <td>20.9947</td>
      <td>20.0873</td>
      <td>19.7947</td>
      <td>19.5552</td>
      <td>1.6094</td>
      <td>1.2054</td>
      <td>0.0</td>
      <td>-0.3070</td>
      <td>-0.1941</td>
      <td>-0.1339</td>
      <td>-0.1003</td>
      <td>-0.0795</td>
      <td>-1.2000</td>
      <td>-1.4395</td>
      <td>0.5321</td>
      <td>0.2395</td>
      <td>-1.3906</td>
    </tr>
    <tr>
      <th>4</th>
      <td>17.9826</td>
      <td>-3.3247e-05</td>
      <td>23.7714</td>
      <td>20.4338</td>
      <td>18.8630</td>
      <td>18.1903</td>
      <td>17.8759</td>
      <td>2.6391</td>
      <td>1.1939</td>
      <td>0.0</td>
      <td>-0.6820</td>
      <td>-0.2653</td>
      <td>-0.1794</td>
      <td>-0.1339</td>
      <td>-0.1067</td>
      <td>-2.2436</td>
      <td>-2.5579</td>
      <td>0.9871</td>
      <td>0.3144</td>
      <td>-9.3609</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">target_col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[:</span><span class="mi">320000</span><span class="p">]</span>
<span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">target_col</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">trn</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">320000</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">tst</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">320000</span><span class="p">:]</span><span class="o">.</span><span class="n">values</span>
<span class="n">feature_name</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">trn</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">tst</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(320000,) (320000, 19) (80000, 19)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="hyperparameter-tuning">
<h2>Hyperparameter Tuning<a class="headerlink" href="#hyperparameter-tuning" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_trn</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_trn</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">trn</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;objective&quot;</span><span class="p">:</span> <span class="s2">&quot;multiclass&quot;</span><span class="p">,</span>
    <span class="s2">&quot;n_estimators&quot;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="s2">&quot;subsample_freq&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;random_state&quot;</span><span class="p">:</span> <span class="n">seed</span><span class="p">,</span>
    <span class="s2">&quot;n_jobs&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">space</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;learning_rate&quot;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">loguniform</span><span class="p">(</span><span class="s2">&quot;learning_rate&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">0.01</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)),</span>
    <span class="s2">&quot;num_leaves&quot;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s2">&quot;num_leaves&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">127</span><span class="p">]),</span>
    <span class="s2">&quot;colsample_bytree&quot;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">quniform</span><span class="p">(</span><span class="s2">&quot;colsample_bytree&quot;</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="o">.</span><span class="mi">9</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span>
    <span class="s2">&quot;subsample&quot;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">quniform</span><span class="p">(</span><span class="s2">&quot;subsample&quot;</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="o">.</span><span class="mi">9</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span>
    <span class="s2">&quot;min_child_samples&quot;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="s1">&#39;min_child_samples&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">100</span><span class="p">])</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">hp</span></code>는 <code class="docutils literal notranslate"><span class="pre">hyperopt</span></code>에서 불러온 모듈이며 <code class="docutils literal notranslate"><span class="pre">hp</span></code>의 각 함수가 뜻하는 바는 아래와 같습니다.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">hp.loguniform(&quot;learning_rate&quot;,</span> <span class="pre">np.log(0.01),</span> <span class="pre">np.log(0.3))</span></code>: learning_rate를 log(0.01)과 log(0.3) 사이의 임의의 값으로 선택</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hp.choice(&quot;num_leaves&quot;,</span> <span class="pre">[15,</span> <span class="pre">31,</span> <span class="pre">63,</span> <span class="pre">127])</span></code>: num_leaves를 15, 31, 63, 127 중 하나의 값으로 선택</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hp.quniform(&quot;colsample_bytree&quot;,</span> <span class="pre">.5,</span> <span class="pre">.9,</span> <span class="pre">0.1)</span></code>: 0.5와 0.9사이의 0.1의 간격을 갖는 값중 하나로 colsample_bytree를 선택</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">objective</span><span class="p">(</span><span class="n">hyperparams</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">lgb</span><span class="o">.</span><span class="n">LGBMClassifier</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">,</span> <span class="o">**</span><span class="n">hyperparams</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X_trn</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_trn</span><span class="p">,</span>
              <span class="n">eval_set</span><span class="o">=</span><span class="p">[(</span><span class="n">X_val</span><span class="p">,</span> <span class="n">y_val</span><span class="p">)],</span>
              <span class="n">eval_metric</span><span class="o">=</span><span class="s2">&quot;multi_logloss&quot;</span><span class="p">,</span>
              <span class="n">early_stopping_rounds</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
              <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">score</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">best_score_</span><span class="p">[</span><span class="s2">&quot;valid_0&quot;</span><span class="p">][</span><span class="s2">&quot;multi_logloss&quot;</span><span class="p">]</span>

    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;loss&#39;</span><span class="p">:</span> <span class="n">score</span><span class="p">,</span> <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="n">STATUS_OK</span><span class="p">,</span> <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="n">model</span><span class="p">}</span>

<span class="n">trials</span> <span class="o">=</span> <span class="n">Trials</span><span class="p">()</span>
<span class="n">best</span> <span class="o">=</span> <span class="n">fmin</span><span class="p">(</span><span class="n">fn</span><span class="o">=</span><span class="n">objective</span><span class="p">,</span> <span class="n">space</span><span class="o">=</span><span class="n">space</span><span class="p">,</span> <span class="n">trials</span><span class="o">=</span><span class="n">trials</span><span class="p">,</span>
            <span class="n">algo</span><span class="o">=</span><span class="n">tpe</span><span class="o">.</span><span class="n">suggest</span><span class="p">,</span> <span class="n">max_evals</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">hyperparams</span> <span class="o">=</span> <span class="n">space_eval</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">best</span><span class="p">)</span>
<span class="n">n_best</span> <span class="o">=</span> <span class="n">trials</span><span class="o">.</span><span class="n">best_trial</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">][</span><span class="s1">&#39;model&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">best_iteration_</span>
<span class="n">params</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">hyperparams</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 10/10 [02:45&lt;00:00, 16.55s/trial, best loss: 0.161683208975629] 
{&#39;objective&#39;: &#39;multiclass&#39;, &#39;n_estimators&#39;: 1000, &#39;subsample_freq&#39;: 1, &#39;random_state&#39;: 42, &#39;n_jobs&#39;: -1, &#39;colsample_bytree&#39;: 0.7000000000000001, &#39;learning_rate&#39;: 0.03108434204266342, &#39;min_child_samples&#39;: 10, &#39;num_leaves&#39;: 127, &#39;subsample&#39;: 0.6000000000000001}
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="stratified-k-fold-cross-validation">
<h2>Stratified K-Fold Cross Validation<a class="headerlink" href="#stratified-k-fold-cross-validation" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cv</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="n">n_fold</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="lightgbm">
<h2>LightGBM 모델 학습<a class="headerlink" href="#lightgbm" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">trn</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">n_class</span><span class="p">))</span>
<span class="n">p_tst</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">tst</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">n_class</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">i_trn</span><span class="p">,</span> <span class="n">i_val</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cv</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">trn</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="mi">1</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;training model for CV #</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">clf</span> <span class="o">=</span> <span class="n">lgb</span><span class="o">.</span><span class="n">LGBMClassifier</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
    <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">trn</span><span class="p">[</span><span class="n">i_trn</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">i_trn</span><span class="p">],</span>
            <span class="n">eval_set</span><span class="o">=</span><span class="p">[(</span><span class="n">trn</span><span class="p">[</span><span class="n">i_val</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">i_val</span><span class="p">])],</span>
            <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;multiclass&#39;</span><span class="p">,</span>
            <span class="n">early_stopping_rounds</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    
    <span class="n">p_val</span><span class="p">[</span><span class="n">i_val</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">trn</span><span class="p">[</span><span class="n">i_val</span><span class="p">])</span>
    <span class="n">p_tst</span> <span class="o">+=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">tst</span><span class="p">)</span> <span class="o">/</span> <span class="n">n_fold</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>training model for CV #1
[1]	valid_0&#39;s multi_logloss: 0.954233
Training until validation scores don&#39;t improve for 10 rounds
[2]	valid_0&#39;s multi_logloss: 0.924743
[3]	valid_0&#39;s multi_logloss: 0.894827
[4]	valid_0&#39;s multi_logloss: 0.866741
[5]	valid_0&#39;s multi_logloss: 0.839951
[6]	valid_0&#39;s multi_logloss: 0.816908
[7]	valid_0&#39;s multi_logloss: 0.793714
[8]	valid_0&#39;s multi_logloss: 0.772796
[9]	valid_0&#39;s multi_logloss: 0.753847
[10]	valid_0&#39;s multi_logloss: 0.73288
[11]	valid_0&#39;s multi_logloss: 0.71286
[12]	valid_0&#39;s multi_logloss: 0.693807
[13]	valid_0&#39;s multi_logloss: 0.675524
[14]	valid_0&#39;s multi_logloss: 0.65779
[15]	valid_0&#39;s multi_logloss: 0.641412
[16]	valid_0&#39;s multi_logloss: 0.626447
[17]	valid_0&#39;s multi_logloss: 0.611459
[18]	valid_0&#39;s multi_logloss: 0.596917
[19]	valid_0&#39;s multi_logloss: 0.583272
[20]	valid_0&#39;s multi_logloss: 0.570976
[21]	valid_0&#39;s multi_logloss: 0.557878
[22]	valid_0&#39;s multi_logloss: 0.545354
[23]	valid_0&#39;s multi_logloss: 0.533336
[24]	valid_0&#39;s multi_logloss: 0.52288
[25]	valid_0&#39;s multi_logloss: 0.511876
[26]	valid_0&#39;s multi_logloss: 0.502915
[27]	valid_0&#39;s multi_logloss: 0.492674
[28]	valid_0&#39;s multi_logloss: 0.482539
[29]	valid_0&#39;s multi_logloss: 0.47385
[30]	valid_0&#39;s multi_logloss: 0.464822
[31]	valid_0&#39;s multi_logloss: 0.457011
[32]	valid_0&#39;s multi_logloss: 0.448649
[33]	valid_0&#39;s multi_logloss: 0.439989
[34]	valid_0&#39;s multi_logloss: 0.431633
[35]	valid_0&#39;s multi_logloss: 0.423759
[36]	valid_0&#39;s multi_logloss: 0.416499
[37]	valid_0&#39;s multi_logloss: 0.409675
[38]	valid_0&#39;s multi_logloss: 0.402948
[39]	valid_0&#39;s multi_logloss: 0.396482
[40]	valid_0&#39;s multi_logloss: 0.390272
[41]	valid_0&#39;s multi_logloss: 0.384193
[42]	valid_0&#39;s multi_logloss: 0.378325
[43]	valid_0&#39;s multi_logloss: 0.372325
[44]	valid_0&#39;s multi_logloss: 0.367487
[45]	valid_0&#39;s multi_logloss: 0.362428
[46]	valid_0&#39;s multi_logloss: 0.357493
[47]	valid_0&#39;s multi_logloss: 0.352895
[48]	valid_0&#39;s multi_logloss: 0.348047
[49]	valid_0&#39;s multi_logloss: 0.34296
[50]	valid_0&#39;s multi_logloss: 0.338691
[51]	valid_0&#39;s multi_logloss: 0.334022
[52]	valid_0&#39;s multi_logloss: 0.329819
[53]	valid_0&#39;s multi_logloss: 0.325557
[54]	valid_0&#39;s multi_logloss: 0.321717
[55]	valid_0&#39;s multi_logloss: 0.317862
[56]	valid_0&#39;s multi_logloss: 0.314433
[57]	valid_0&#39;s multi_logloss: 0.311109
[58]	valid_0&#39;s multi_logloss: 0.307696
[59]	valid_0&#39;s multi_logloss: 0.303858
[60]	valid_0&#39;s multi_logloss: 0.300642
[61]	valid_0&#39;s multi_logloss: 0.296929
[62]	valid_0&#39;s multi_logloss: 0.293582
[63]	valid_0&#39;s multi_logloss: 0.290824
[64]	valid_0&#39;s multi_logloss: 0.287785
[65]	valid_0&#39;s multi_logloss: 0.284729
[66]	valid_0&#39;s multi_logloss: 0.281985
[67]	valid_0&#39;s multi_logloss: 0.278864
[68]	valid_0&#39;s multi_logloss: 0.275776
[69]	valid_0&#39;s multi_logloss: 0.273325
[70]	valid_0&#39;s multi_logloss: 0.270471
[71]	valid_0&#39;s multi_logloss: 0.268078
[72]	valid_0&#39;s multi_logloss: 0.26569
[73]	valid_0&#39;s multi_logloss: 0.263856
[74]	valid_0&#39;s multi_logloss: 0.261546
[75]	valid_0&#39;s multi_logloss: 0.259072
[76]	valid_0&#39;s multi_logloss: 0.257032
[77]	valid_0&#39;s multi_logloss: 0.254743
[78]	valid_0&#39;s multi_logloss: 0.252826
[79]	valid_0&#39;s multi_logloss: 0.250495
[80]	valid_0&#39;s multi_logloss: 0.248533
[81]	valid_0&#39;s multi_logloss: 0.246417
[82]	valid_0&#39;s multi_logloss: 0.244279
[83]	valid_0&#39;s multi_logloss: 0.242394
[84]	valid_0&#39;s multi_logloss: 0.240407
[85]	valid_0&#39;s multi_logloss: 0.238411
[86]	valid_0&#39;s multi_logloss: 0.23651
[87]	valid_0&#39;s multi_logloss: 0.234916
[88]	valid_0&#39;s multi_logloss: 0.233498
[89]	valid_0&#39;s multi_logloss: 0.23182
[90]	valid_0&#39;s multi_logloss: 0.230206
[91]	valid_0&#39;s multi_logloss: 0.228598
[92]	valid_0&#39;s multi_logloss: 0.227232
[93]	valid_0&#39;s multi_logloss: 0.225791
[94]	valid_0&#39;s multi_logloss: 0.224252
[95]	valid_0&#39;s multi_logloss: 0.222898
[96]	valid_0&#39;s multi_logloss: 0.221475
[97]	valid_0&#39;s multi_logloss: 0.220176
[98]	valid_0&#39;s multi_logloss: 0.218769
[99]	valid_0&#39;s multi_logloss: 0.21753
[100]	valid_0&#39;s multi_logloss: 0.216235
[101]	valid_0&#39;s multi_logloss: 0.215123
[102]	valid_0&#39;s multi_logloss: 0.213974
[103]	valid_0&#39;s multi_logloss: 0.212703
[104]	valid_0&#39;s multi_logloss: 0.211631
[105]	valid_0&#39;s multi_logloss: 0.210507
[106]	valid_0&#39;s multi_logloss: 0.20951
[107]	valid_0&#39;s multi_logloss: 0.208715
[108]	valid_0&#39;s multi_logloss: 0.207597
[109]	valid_0&#39;s multi_logloss: 0.20663
[110]	valid_0&#39;s multi_logloss: 0.205825
[111]	valid_0&#39;s multi_logloss: 0.20503
[112]	valid_0&#39;s multi_logloss: 0.204289
[113]	valid_0&#39;s multi_logloss: 0.203358
[114]	valid_0&#39;s multi_logloss: 0.202571
[115]	valid_0&#39;s multi_logloss: 0.201693
[116]	valid_0&#39;s multi_logloss: 0.200802
[117]	valid_0&#39;s multi_logloss: 0.199867
[118]	valid_0&#39;s multi_logloss: 0.199189
[119]	valid_0&#39;s multi_logloss: 0.19861
[120]	valid_0&#39;s multi_logloss: 0.19777
[121]	valid_0&#39;s multi_logloss: 0.197159
[122]	valid_0&#39;s multi_logloss: 0.196536
[123]	valid_0&#39;s multi_logloss: 0.195766
[124]	valid_0&#39;s multi_logloss: 0.195083
[125]	valid_0&#39;s multi_logloss: 0.194401
[126]	valid_0&#39;s multi_logloss: 0.193912
[127]	valid_0&#39;s multi_logloss: 0.193347
[128]	valid_0&#39;s multi_logloss: 0.192743
[129]	valid_0&#39;s multi_logloss: 0.192159
[130]	valid_0&#39;s multi_logloss: 0.191483
[131]	valid_0&#39;s multi_logloss: 0.190845
[132]	valid_0&#39;s multi_logloss: 0.190304
[133]	valid_0&#39;s multi_logloss: 0.189765
[134]	valid_0&#39;s multi_logloss: 0.189191
[135]	valid_0&#39;s multi_logloss: 0.188617
[136]	valid_0&#39;s multi_logloss: 0.188002
[137]	valid_0&#39;s multi_logloss: 0.187529
[138]	valid_0&#39;s multi_logloss: 0.186914
[139]	valid_0&#39;s multi_logloss: 0.186504
[140]	valid_0&#39;s multi_logloss: 0.186058
[141]	valid_0&#39;s multi_logloss: 0.185582
[142]	valid_0&#39;s multi_logloss: 0.185127
[143]	valid_0&#39;s multi_logloss: 0.184807
[144]	valid_0&#39;s multi_logloss: 0.184323
[145]	valid_0&#39;s multi_logloss: 0.18394
[146]	valid_0&#39;s multi_logloss: 0.183597
[147]	valid_0&#39;s multi_logloss: 0.183122
[148]	valid_0&#39;s multi_logloss: 0.182736
[149]	valid_0&#39;s multi_logloss: 0.182353
[150]	valid_0&#39;s multi_logloss: 0.181964
[151]	valid_0&#39;s multi_logloss: 0.181597
[152]	valid_0&#39;s multi_logloss: 0.181289
[153]	valid_0&#39;s multi_logloss: 0.180907
[154]	valid_0&#39;s multi_logloss: 0.180591
[155]	valid_0&#39;s multi_logloss: 0.180188
[156]	valid_0&#39;s multi_logloss: 0.179846
[157]	valid_0&#39;s multi_logloss: 0.179646
[158]	valid_0&#39;s multi_logloss: 0.179329
[159]	valid_0&#39;s multi_logloss: 0.178922
[160]	valid_0&#39;s multi_logloss: 0.178573
[161]	valid_0&#39;s multi_logloss: 0.178333
[162]	valid_0&#39;s multi_logloss: 0.178021
[163]	valid_0&#39;s multi_logloss: 0.177671
[164]	valid_0&#39;s multi_logloss: 0.177333
[165]	valid_0&#39;s multi_logloss: 0.177045
[166]	valid_0&#39;s multi_logloss: 0.176691
[167]	valid_0&#39;s multi_logloss: 0.176368
[168]	valid_0&#39;s multi_logloss: 0.17606
[169]	valid_0&#39;s multi_logloss: 0.175742
[170]	valid_0&#39;s multi_logloss: 0.175481
[171]	valid_0&#39;s multi_logloss: 0.175228
[172]	valid_0&#39;s multi_logloss: 0.174929
[173]	valid_0&#39;s multi_logloss: 0.174696
[174]	valid_0&#39;s multi_logloss: 0.174385
[175]	valid_0&#39;s multi_logloss: 0.174186
[176]	valid_0&#39;s multi_logloss: 0.173872
[177]	valid_0&#39;s multi_logloss: 0.173648
[178]	valid_0&#39;s multi_logloss: 0.173435
[179]	valid_0&#39;s multi_logloss: 0.173255
[180]	valid_0&#39;s multi_logloss: 0.173014
[181]	valid_0&#39;s multi_logloss: 0.172819
[182]	valid_0&#39;s multi_logloss: 0.172594
[183]	valid_0&#39;s multi_logloss: 0.172373
[184]	valid_0&#39;s multi_logloss: 0.172181
[185]	valid_0&#39;s multi_logloss: 0.171998
[186]	valid_0&#39;s multi_logloss: 0.171778
[187]	valid_0&#39;s multi_logloss: 0.171631
[188]	valid_0&#39;s multi_logloss: 0.171407
[189]	valid_0&#39;s multi_logloss: 0.171195
[190]	valid_0&#39;s multi_logloss: 0.17098
[191]	valid_0&#39;s multi_logloss: 0.170773
[192]	valid_0&#39;s multi_logloss: 0.170627
[193]	valid_0&#39;s multi_logloss: 0.170502
[194]	valid_0&#39;s multi_logloss: 0.170331
[195]	valid_0&#39;s multi_logloss: 0.170119
[196]	valid_0&#39;s multi_logloss: 0.169961
[197]	valid_0&#39;s multi_logloss: 0.169793
[198]	valid_0&#39;s multi_logloss: 0.169618
[199]	valid_0&#39;s multi_logloss: 0.169445
[200]	valid_0&#39;s multi_logloss: 0.169273
[201]	valid_0&#39;s multi_logloss: 0.169092
[202]	valid_0&#39;s multi_logloss: 0.16895
[203]	valid_0&#39;s multi_logloss: 0.168848
[204]	valid_0&#39;s multi_logloss: 0.168735
[205]	valid_0&#39;s multi_logloss: 0.168647
[206]	valid_0&#39;s multi_logloss: 0.168482
[207]	valid_0&#39;s multi_logloss: 0.168363
[208]	valid_0&#39;s multi_logloss: 0.16824
[209]	valid_0&#39;s multi_logloss: 0.16811
[210]	valid_0&#39;s multi_logloss: 0.167952
[211]	valid_0&#39;s multi_logloss: 0.167869
[212]	valid_0&#39;s multi_logloss: 0.167742
[213]	valid_0&#39;s multi_logloss: 0.167655
[214]	valid_0&#39;s multi_logloss: 0.167534
[215]	valid_0&#39;s multi_logloss: 0.167433
[216]	valid_0&#39;s multi_logloss: 0.16729
[217]	valid_0&#39;s multi_logloss: 0.167203
[218]	valid_0&#39;s multi_logloss: 0.167126
[219]	valid_0&#39;s multi_logloss: 0.167008
[220]	valid_0&#39;s multi_logloss: 0.166889
[221]	valid_0&#39;s multi_logloss: 0.166763
[222]	valid_0&#39;s multi_logloss: 0.166685
[223]	valid_0&#39;s multi_logloss: 0.166572
[224]	valid_0&#39;s multi_logloss: 0.166463
[225]	valid_0&#39;s multi_logloss: 0.166375
[226]	valid_0&#39;s multi_logloss: 0.166283
[227]	valid_0&#39;s multi_logloss: 0.166225
[228]	valid_0&#39;s multi_logloss: 0.166126
[229]	valid_0&#39;s multi_logloss: 0.16602
[230]	valid_0&#39;s multi_logloss: 0.165921
[231]	valid_0&#39;s multi_logloss: 0.165828
[232]	valid_0&#39;s multi_logloss: 0.165753
[233]	valid_0&#39;s multi_logloss: 0.165677
[234]	valid_0&#39;s multi_logloss: 0.165592
[235]	valid_0&#39;s multi_logloss: 0.1655
[236]	valid_0&#39;s multi_logloss: 0.165412
[237]	valid_0&#39;s multi_logloss: 0.165325
[238]	valid_0&#39;s multi_logloss: 0.165271
[239]	valid_0&#39;s multi_logloss: 0.165188
[240]	valid_0&#39;s multi_logloss: 0.165086
[241]	valid_0&#39;s multi_logloss: 0.164986
[242]	valid_0&#39;s multi_logloss: 0.164908
[243]	valid_0&#39;s multi_logloss: 0.164815
[244]	valid_0&#39;s multi_logloss: 0.164727
[245]	valid_0&#39;s multi_logloss: 0.164684
[246]	valid_0&#39;s multi_logloss: 0.164634
[247]	valid_0&#39;s multi_logloss: 0.164567
[248]	valid_0&#39;s multi_logloss: 0.164515
[249]	valid_0&#39;s multi_logloss: 0.16442
[250]	valid_0&#39;s multi_logloss: 0.164347
[251]	valid_0&#39;s multi_logloss: 0.164289
[252]	valid_0&#39;s multi_logloss: 0.164229
[253]	valid_0&#39;s multi_logloss: 0.164173
[254]	valid_0&#39;s multi_logloss: 0.164132
[255]	valid_0&#39;s multi_logloss: 0.164074
[256]	valid_0&#39;s multi_logloss: 0.164013
[257]	valid_0&#39;s multi_logloss: 0.163914
[258]	valid_0&#39;s multi_logloss: 0.163858
[259]	valid_0&#39;s multi_logloss: 0.163809
[260]	valid_0&#39;s multi_logloss: 0.163752
[261]	valid_0&#39;s multi_logloss: 0.16369
[262]	valid_0&#39;s multi_logloss: 0.163638
[263]	valid_0&#39;s multi_logloss: 0.163574
[264]	valid_0&#39;s multi_logloss: 0.163497
[265]	valid_0&#39;s multi_logloss: 0.163446
[266]	valid_0&#39;s multi_logloss: 0.163405
[267]	valid_0&#39;s multi_logloss: 0.163359
[268]	valid_0&#39;s multi_logloss: 0.163318
[269]	valid_0&#39;s multi_logloss: 0.163272
[270]	valid_0&#39;s multi_logloss: 0.163197
[271]	valid_0&#39;s multi_logloss: 0.163153
[272]	valid_0&#39;s multi_logloss: 0.16311
[273]	valid_0&#39;s multi_logloss: 0.163081
[274]	valid_0&#39;s multi_logloss: 0.163028
[275]	valid_0&#39;s multi_logloss: 0.162973
[276]	valid_0&#39;s multi_logloss: 0.162931
[277]	valid_0&#39;s multi_logloss: 0.16288
[278]	valid_0&#39;s multi_logloss: 0.162811
[279]	valid_0&#39;s multi_logloss: 0.162758
[280]	valid_0&#39;s multi_logloss: 0.162727
[281]	valid_0&#39;s multi_logloss: 0.162673
[282]	valid_0&#39;s multi_logloss: 0.162636
[283]	valid_0&#39;s multi_logloss: 0.162595
[284]	valid_0&#39;s multi_logloss: 0.162546
[285]	valid_0&#39;s multi_logloss: 0.162516
[286]	valid_0&#39;s multi_logloss: 0.162483
[287]	valid_0&#39;s multi_logloss: 0.162452
[288]	valid_0&#39;s multi_logloss: 0.162416
[289]	valid_0&#39;s multi_logloss: 0.162359
[290]	valid_0&#39;s multi_logloss: 0.162308
[291]	valid_0&#39;s multi_logloss: 0.162253
[292]	valid_0&#39;s multi_logloss: 0.162216
[293]	valid_0&#39;s multi_logloss: 0.162179
[294]	valid_0&#39;s multi_logloss: 0.162157
[295]	valid_0&#39;s multi_logloss: 0.162116
[296]	valid_0&#39;s multi_logloss: 0.16209
[297]	valid_0&#39;s multi_logloss: 0.162052
[298]	valid_0&#39;s multi_logloss: 0.162009
[299]	valid_0&#39;s multi_logloss: 0.161967
[300]	valid_0&#39;s multi_logloss: 0.161939
[301]	valid_0&#39;s multi_logloss: 0.161896
[302]	valid_0&#39;s multi_logloss: 0.161875
[303]	valid_0&#39;s multi_logloss: 0.161842
[304]	valid_0&#39;s multi_logloss: 0.161801
[305]	valid_0&#39;s multi_logloss: 0.161757
[306]	valid_0&#39;s multi_logloss: 0.161744
[307]	valid_0&#39;s multi_logloss: 0.161722
[308]	valid_0&#39;s multi_logloss: 0.161715
[309]	valid_0&#39;s multi_logloss: 0.161693
[310]	valid_0&#39;s multi_logloss: 0.16169
[311]	valid_0&#39;s multi_logloss: 0.161663
[312]	valid_0&#39;s multi_logloss: 0.161637
[313]	valid_0&#39;s multi_logloss: 0.161618
[314]	valid_0&#39;s multi_logloss: 0.161573
[315]	valid_0&#39;s multi_logloss: 0.161544
[316]	valid_0&#39;s multi_logloss: 0.161516
[317]	valid_0&#39;s multi_logloss: 0.161476
[318]	valid_0&#39;s multi_logloss: 0.161449
[319]	valid_0&#39;s multi_logloss: 0.161434
[320]	valid_0&#39;s multi_logloss: 0.161421
[321]	valid_0&#39;s multi_logloss: 0.161385
[322]	valid_0&#39;s multi_logloss: 0.161363
[323]	valid_0&#39;s multi_logloss: 0.161328
[324]	valid_0&#39;s multi_logloss: 0.161301
[325]	valid_0&#39;s multi_logloss: 0.161278
[326]	valid_0&#39;s multi_logloss: 0.161266
[327]	valid_0&#39;s multi_logloss: 0.161246
[328]	valid_0&#39;s multi_logloss: 0.161212
[329]	valid_0&#39;s multi_logloss: 0.161192
[330]	valid_0&#39;s multi_logloss: 0.161195
[331]	valid_0&#39;s multi_logloss: 0.161174
[332]	valid_0&#39;s multi_logloss: 0.161138
[333]	valid_0&#39;s multi_logloss: 0.161127
[334]	valid_0&#39;s multi_logloss: 0.161105
[335]	valid_0&#39;s multi_logloss: 0.161092
[336]	valid_0&#39;s multi_logloss: 0.161065
[337]	valid_0&#39;s multi_logloss: 0.161052
[338]	valid_0&#39;s multi_logloss: 0.16104
[339]	valid_0&#39;s multi_logloss: 0.16102
[340]	valid_0&#39;s multi_logloss: 0.161009
[341]	valid_0&#39;s multi_logloss: 0.161001
[342]	valid_0&#39;s multi_logloss: 0.160988
[343]	valid_0&#39;s multi_logloss: 0.160965
[344]	valid_0&#39;s multi_logloss: 0.160945
[345]	valid_0&#39;s multi_logloss: 0.160931
[346]	valid_0&#39;s multi_logloss: 0.160903
[347]	valid_0&#39;s multi_logloss: 0.160884
[348]	valid_0&#39;s multi_logloss: 0.16085
[349]	valid_0&#39;s multi_logloss: 0.160845
[350]	valid_0&#39;s multi_logloss: 0.160838
[351]	valid_0&#39;s multi_logloss: 0.160822
[352]	valid_0&#39;s multi_logloss: 0.160803
[353]	valid_0&#39;s multi_logloss: 0.160773
[354]	valid_0&#39;s multi_logloss: 0.160742
[355]	valid_0&#39;s multi_logloss: 0.160713
[356]	valid_0&#39;s multi_logloss: 0.16071
[357]	valid_0&#39;s multi_logloss: 0.160691
[358]	valid_0&#39;s multi_logloss: 0.160685
[359]	valid_0&#39;s multi_logloss: 0.160681
[360]	valid_0&#39;s multi_logloss: 0.160669
[361]	valid_0&#39;s multi_logloss: 0.160643
[362]	valid_0&#39;s multi_logloss: 0.160627
[363]	valid_0&#39;s multi_logloss: 0.160617
[364]	valid_0&#39;s multi_logloss: 0.160625
[365]	valid_0&#39;s multi_logloss: 0.160604
[366]	valid_0&#39;s multi_logloss: 0.160601
[367]	valid_0&#39;s multi_logloss: 0.160596
[368]	valid_0&#39;s multi_logloss: 0.160579
[369]	valid_0&#39;s multi_logloss: 0.160577
[370]	valid_0&#39;s multi_logloss: 0.160571
[371]	valid_0&#39;s multi_logloss: 0.160556
[372]	valid_0&#39;s multi_logloss: 0.160558
[373]	valid_0&#39;s multi_logloss: 0.160538
[374]	valid_0&#39;s multi_logloss: 0.160512
[375]	valid_0&#39;s multi_logloss: 0.160495
[376]	valid_0&#39;s multi_logloss: 0.160481
[377]	valid_0&#39;s multi_logloss: 0.160466
[378]	valid_0&#39;s multi_logloss: 0.160457
[379]	valid_0&#39;s multi_logloss: 0.16046
[380]	valid_0&#39;s multi_logloss: 0.16044
[381]	valid_0&#39;s multi_logloss: 0.160432
[382]	valid_0&#39;s multi_logloss: 0.160429
[383]	valid_0&#39;s multi_logloss: 0.160419
[384]	valid_0&#39;s multi_logloss: 0.160413
[385]	valid_0&#39;s multi_logloss: 0.160405
[386]	valid_0&#39;s multi_logloss: 0.160371
[387]	valid_0&#39;s multi_logloss: 0.160346
[388]	valid_0&#39;s multi_logloss: 0.160337
[389]	valid_0&#39;s multi_logloss: 0.160335
[390]	valid_0&#39;s multi_logloss: 0.16033
[391]	valid_0&#39;s multi_logloss: 0.160307
[392]	valid_0&#39;s multi_logloss: 0.160301
[393]	valid_0&#39;s multi_logloss: 0.1603
[394]	valid_0&#39;s multi_logloss: 0.160272
[395]	valid_0&#39;s multi_logloss: 0.160266
[396]	valid_0&#39;s multi_logloss: 0.160253
[397]	valid_0&#39;s multi_logloss: 0.160239
[398]	valid_0&#39;s multi_logloss: 0.160228
[399]	valid_0&#39;s multi_logloss: 0.160215
[400]	valid_0&#39;s multi_logloss: 0.16021
[401]	valid_0&#39;s multi_logloss: 0.160201
[402]	valid_0&#39;s multi_logloss: 0.160199
[403]	valid_0&#39;s multi_logloss: 0.1602
[404]	valid_0&#39;s multi_logloss: 0.160197
[405]	valid_0&#39;s multi_logloss: 0.1602
[406]	valid_0&#39;s multi_logloss: 0.160191
[407]	valid_0&#39;s multi_logloss: 0.1602
[408]	valid_0&#39;s multi_logloss: 0.160195
[409]	valid_0&#39;s multi_logloss: 0.160185
[410]	valid_0&#39;s multi_logloss: 0.160179
[411]	valid_0&#39;s multi_logloss: 0.160167
[412]	valid_0&#39;s multi_logloss: 0.16016
[413]	valid_0&#39;s multi_logloss: 0.160155
[414]	valid_0&#39;s multi_logloss: 0.160142
[415]	valid_0&#39;s multi_logloss: 0.160141
[416]	valid_0&#39;s multi_logloss: 0.160129
[417]	valid_0&#39;s multi_logloss: 0.160125
[418]	valid_0&#39;s multi_logloss: 0.160121
[419]	valid_0&#39;s multi_logloss: 0.160103
[420]	valid_0&#39;s multi_logloss: 0.160108
[421]	valid_0&#39;s multi_logloss: 0.160092
[422]	valid_0&#39;s multi_logloss: 0.160078
[423]	valid_0&#39;s multi_logloss: 0.160082
[424]	valid_0&#39;s multi_logloss: 0.160064
[425]	valid_0&#39;s multi_logloss: 0.160055
[426]	valid_0&#39;s multi_logloss: 0.160047
[427]	valid_0&#39;s multi_logloss: 0.160034
[428]	valid_0&#39;s multi_logloss: 0.160026
[429]	valid_0&#39;s multi_logloss: 0.160011
[430]	valid_0&#39;s multi_logloss: 0.160007
[431]	valid_0&#39;s multi_logloss: 0.159993
[432]	valid_0&#39;s multi_logloss: 0.159981
[433]	valid_0&#39;s multi_logloss: 0.159985
[434]	valid_0&#39;s multi_logloss: 0.159976
[435]	valid_0&#39;s multi_logloss: 0.159972
[436]	valid_0&#39;s multi_logloss: 0.159973
[437]	valid_0&#39;s multi_logloss: 0.159971
[438]	valid_0&#39;s multi_logloss: 0.159968
[439]	valid_0&#39;s multi_logloss: 0.159958
[440]	valid_0&#39;s multi_logloss: 0.159958
[441]	valid_0&#39;s multi_logloss: 0.159961
[442]	valid_0&#39;s multi_logloss: 0.15996
[443]	valid_0&#39;s multi_logloss: 0.159945
[444]	valid_0&#39;s multi_logloss: 0.159936
[445]	valid_0&#39;s multi_logloss: 0.159932
[446]	valid_0&#39;s multi_logloss: 0.159922
[447]	valid_0&#39;s multi_logloss: 0.159913
[448]	valid_0&#39;s multi_logloss: 0.159915
[449]	valid_0&#39;s multi_logloss: 0.159906
[450]	valid_0&#39;s multi_logloss: 0.159887
[451]	valid_0&#39;s multi_logloss: 0.159875
[452]	valid_0&#39;s multi_logloss: 0.159869
[453]	valid_0&#39;s multi_logloss: 0.159859
[454]	valid_0&#39;s multi_logloss: 0.159859
[455]	valid_0&#39;s multi_logloss: 0.159852
[456]	valid_0&#39;s multi_logloss: 0.159846
[457]	valid_0&#39;s multi_logloss: 0.159848
[458]	valid_0&#39;s multi_logloss: 0.159837
[459]	valid_0&#39;s multi_logloss: 0.159828
[460]	valid_0&#39;s multi_logloss: 0.15982
[461]	valid_0&#39;s multi_logloss: 0.159821
[462]	valid_0&#39;s multi_logloss: 0.159824
[463]	valid_0&#39;s multi_logloss: 0.159824
[464]	valid_0&#39;s multi_logloss: 0.159812
[465]	valid_0&#39;s multi_logloss: 0.159809
[466]	valid_0&#39;s multi_logloss: 0.159805
[467]	valid_0&#39;s multi_logloss: 0.159798
[468]	valid_0&#39;s multi_logloss: 0.159794
[469]	valid_0&#39;s multi_logloss: 0.159792
[470]	valid_0&#39;s multi_logloss: 0.159796
[471]	valid_0&#39;s multi_logloss: 0.159793
[472]	valid_0&#39;s multi_logloss: 0.1598
[473]	valid_0&#39;s multi_logloss: 0.159794
[474]	valid_0&#39;s multi_logloss: 0.159782
[475]	valid_0&#39;s multi_logloss: 0.15978
[476]	valid_0&#39;s multi_logloss: 0.159769
[477]	valid_0&#39;s multi_logloss: 0.159763
[478]	valid_0&#39;s multi_logloss: 0.159756
[479]	valid_0&#39;s multi_logloss: 0.159761
[480]	valid_0&#39;s multi_logloss: 0.159759
[481]	valid_0&#39;s multi_logloss: 0.15975
[482]	valid_0&#39;s multi_logloss: 0.159744
[483]	valid_0&#39;s multi_logloss: 0.159729
[484]	valid_0&#39;s multi_logloss: 0.159723
[485]	valid_0&#39;s multi_logloss: 0.15973
[486]	valid_0&#39;s multi_logloss: 0.159737
[487]	valid_0&#39;s multi_logloss: 0.15972
[488]	valid_0&#39;s multi_logloss: 0.159718
[489]	valid_0&#39;s multi_logloss: 0.159699
[490]	valid_0&#39;s multi_logloss: 0.159716
[491]	valid_0&#39;s multi_logloss: 0.159706
[492]	valid_0&#39;s multi_logloss: 0.159705
[493]	valid_0&#39;s multi_logloss: 0.159695
[494]	valid_0&#39;s multi_logloss: 0.159691
[495]	valid_0&#39;s multi_logloss: 0.159688
[496]	valid_0&#39;s multi_logloss: 0.159677
[497]	valid_0&#39;s multi_logloss: 0.159665
[498]	valid_0&#39;s multi_logloss: 0.15966
[499]	valid_0&#39;s multi_logloss: 0.15966
[500]	valid_0&#39;s multi_logloss: 0.15965
[501]	valid_0&#39;s multi_logloss: 0.159638
[502]	valid_0&#39;s multi_logloss: 0.159638
[503]	valid_0&#39;s multi_logloss: 0.159635
[504]	valid_0&#39;s multi_logloss: 0.159641
[505]	valid_0&#39;s multi_logloss: 0.159631
[506]	valid_0&#39;s multi_logloss: 0.159629
[507]	valid_0&#39;s multi_logloss: 0.159622
[508]	valid_0&#39;s multi_logloss: 0.159611
[509]	valid_0&#39;s multi_logloss: 0.159615
[510]	valid_0&#39;s multi_logloss: 0.159609
[511]	valid_0&#39;s multi_logloss: 0.159606
[512]	valid_0&#39;s multi_logloss: 0.159598
[513]	valid_0&#39;s multi_logloss: 0.1596
[514]	valid_0&#39;s multi_logloss: 0.159596
[515]	valid_0&#39;s multi_logloss: 0.159608
[516]	valid_0&#39;s multi_logloss: 0.159599
[517]	valid_0&#39;s multi_logloss: 0.159608
[518]	valid_0&#39;s multi_logloss: 0.159612
[519]	valid_0&#39;s multi_logloss: 0.159605
[520]	valid_0&#39;s multi_logloss: 0.159603
[521]	valid_0&#39;s multi_logloss: 0.159604
[522]	valid_0&#39;s multi_logloss: 0.15961
[523]	valid_0&#39;s multi_logloss: 0.159611
[524]	valid_0&#39;s multi_logloss: 0.159626
Early stopping, best iteration is:
[514]	valid_0&#39;s multi_logloss: 0.159596
training model for CV #2
[1]	valid_0&#39;s multi_logloss: 0.954226
Training until validation scores don&#39;t improve for 10 rounds
[2]	valid_0&#39;s multi_logloss: 0.924784
[3]	valid_0&#39;s multi_logloss: 0.894989
[4]	valid_0&#39;s multi_logloss: 0.866925
[5]	valid_0&#39;s multi_logloss: 0.840153
[6]	valid_0&#39;s multi_logloss: 0.817084
[7]	valid_0&#39;s multi_logloss: 0.793894
[8]	valid_0&#39;s multi_logloss: 0.773023
[9]	valid_0&#39;s multi_logloss: 0.754182
[10]	valid_0&#39;s multi_logloss: 0.733113
[11]	valid_0&#39;s multi_logloss: 0.713224
[12]	valid_0&#39;s multi_logloss: 0.694251
[13]	valid_0&#39;s multi_logloss: 0.676042
[14]	valid_0&#39;s multi_logloss: 0.658449
[15]	valid_0&#39;s multi_logloss: 0.641972
[16]	valid_0&#39;s multi_logloss: 0.62707
[17]	valid_0&#39;s multi_logloss: 0.612085
[18]	valid_0&#39;s multi_logloss: 0.59743
[19]	valid_0&#39;s multi_logloss: 0.583853
[20]	valid_0&#39;s multi_logloss: 0.571533
[21]	valid_0&#39;s multi_logloss: 0.558489
[22]	valid_0&#39;s multi_logloss: 0.546014
[23]	valid_0&#39;s multi_logloss: 0.534088
[24]	valid_0&#39;s multi_logloss: 0.523599
[25]	valid_0&#39;s multi_logloss: 0.51263
[26]	valid_0&#39;s multi_logloss: 0.503754
[27]	valid_0&#39;s multi_logloss: 0.493575
[28]	valid_0&#39;s multi_logloss: 0.483382
[29]	valid_0&#39;s multi_logloss: 0.474761
[30]	valid_0&#39;s multi_logloss: 0.465728
[31]	valid_0&#39;s multi_logloss: 0.457935
[32]	valid_0&#39;s multi_logloss: 0.449583
[33]	valid_0&#39;s multi_logloss: 0.440934
[34]	valid_0&#39;s multi_logloss: 0.432593
[35]	valid_0&#39;s multi_logloss: 0.424801
[36]	valid_0&#39;s multi_logloss: 0.417513
[37]	valid_0&#39;s multi_logloss: 0.410577
[38]	valid_0&#39;s multi_logloss: 0.404002
[39]	valid_0&#39;s multi_logloss: 0.397556
[40]	valid_0&#39;s multi_logloss: 0.391375
[41]	valid_0&#39;s multi_logloss: 0.385369
[42]	valid_0&#39;s multi_logloss: 0.37949
[43]	valid_0&#39;s multi_logloss: 0.373466
[44]	valid_0&#39;s multi_logloss: 0.368639
[45]	valid_0&#39;s multi_logloss: 0.363511
[46]	valid_0&#39;s multi_logloss: 0.358599
[47]	valid_0&#39;s multi_logloss: 0.353893
[48]	valid_0&#39;s multi_logloss: 0.349056
[49]	valid_0&#39;s multi_logloss: 0.34386
[50]	valid_0&#39;s multi_logloss: 0.339551
[51]	valid_0&#39;s multi_logloss: 0.334862
[52]	valid_0&#39;s multi_logloss: 0.330672
[53]	valid_0&#39;s multi_logloss: 0.326473
[54]	valid_0&#39;s multi_logloss: 0.322676
[55]	valid_0&#39;s multi_logloss: 0.318811
[56]	valid_0&#39;s multi_logloss: 0.315438
[57]	valid_0&#39;s multi_logloss: 0.312083
[58]	valid_0&#39;s multi_logloss: 0.308628
[59]	valid_0&#39;s multi_logloss: 0.304815
[60]	valid_0&#39;s multi_logloss: 0.301583
[61]	valid_0&#39;s multi_logloss: 0.29792
[62]	valid_0&#39;s multi_logloss: 0.294581
[63]	valid_0&#39;s multi_logloss: 0.291822
[64]	valid_0&#39;s multi_logloss: 0.288761
[65]	valid_0&#39;s multi_logloss: 0.285685
[66]	valid_0&#39;s multi_logloss: 0.282964
[67]	valid_0&#39;s multi_logloss: 0.279864
[68]	valid_0&#39;s multi_logloss: 0.2768
[69]	valid_0&#39;s multi_logloss: 0.274346
[70]	valid_0&#39;s multi_logloss: 0.271492
[71]	valid_0&#39;s multi_logloss: 0.269044
[72]	valid_0&#39;s multi_logloss: 0.266644
[73]	valid_0&#39;s multi_logloss: 0.264858
[74]	valid_0&#39;s multi_logloss: 0.26257
[75]	valid_0&#39;s multi_logloss: 0.260064
[76]	valid_0&#39;s multi_logloss: 0.257982
[77]	valid_0&#39;s multi_logloss: 0.255678
[78]	valid_0&#39;s multi_logloss: 0.253705
[79]	valid_0&#39;s multi_logloss: 0.251383
[80]	valid_0&#39;s multi_logloss: 0.249398
[81]	valid_0&#39;s multi_logloss: 0.24732
[82]	valid_0&#39;s multi_logloss: 0.24519
[83]	valid_0&#39;s multi_logloss: 0.243267
[84]	valid_0&#39;s multi_logloss: 0.241318
[85]	valid_0&#39;s multi_logloss: 0.239285
[86]	valid_0&#39;s multi_logloss: 0.237404
[87]	valid_0&#39;s multi_logloss: 0.23583
[88]	valid_0&#39;s multi_logloss: 0.234413
[89]	valid_0&#39;s multi_logloss: 0.232736
[90]	valid_0&#39;s multi_logloss: 0.231083
[91]	valid_0&#39;s multi_logloss: 0.229484
[92]	valid_0&#39;s multi_logloss: 0.228146
[93]	valid_0&#39;s multi_logloss: 0.226688
[94]	valid_0&#39;s multi_logloss: 0.225147
[95]	valid_0&#39;s multi_logloss: 0.223792
[96]	valid_0&#39;s multi_logloss: 0.222354
[97]	valid_0&#39;s multi_logloss: 0.22106
[98]	valid_0&#39;s multi_logloss: 0.219663
[99]	valid_0&#39;s multi_logloss: 0.218441
[100]	valid_0&#39;s multi_logloss: 0.217185
[101]	valid_0&#39;s multi_logloss: 0.216009
[102]	valid_0&#39;s multi_logloss: 0.214882
[103]	valid_0&#39;s multi_logloss: 0.213669
[104]	valid_0&#39;s multi_logloss: 0.212603
[105]	valid_0&#39;s multi_logloss: 0.211497
[106]	valid_0&#39;s multi_logloss: 0.210492
[107]	valid_0&#39;s multi_logloss: 0.20973
[108]	valid_0&#39;s multi_logloss: 0.20862
[109]	valid_0&#39;s multi_logloss: 0.207614
[110]	valid_0&#39;s multi_logloss: 0.20681
[111]	valid_0&#39;s multi_logloss: 0.206026
[112]	valid_0&#39;s multi_logloss: 0.205273
[113]	valid_0&#39;s multi_logloss: 0.204342
[114]	valid_0&#39;s multi_logloss: 0.203568
[115]	valid_0&#39;s multi_logloss: 0.202677
[116]	valid_0&#39;s multi_logloss: 0.201786
[117]	valid_0&#39;s multi_logloss: 0.200867
[118]	valid_0&#39;s multi_logloss: 0.20015
[119]	valid_0&#39;s multi_logloss: 0.199589
[120]	valid_0&#39;s multi_logloss: 0.19875
[121]	valid_0&#39;s multi_logloss: 0.198134
[122]	valid_0&#39;s multi_logloss: 0.197505
[123]	valid_0&#39;s multi_logloss: 0.196762
[124]	valid_0&#39;s multi_logloss: 0.196116
[125]	valid_0&#39;s multi_logloss: 0.195444
[126]	valid_0&#39;s multi_logloss: 0.194924
[127]	valid_0&#39;s multi_logloss: 0.194321
[128]	valid_0&#39;s multi_logloss: 0.193692
[129]	valid_0&#39;s multi_logloss: 0.193134
[130]	valid_0&#39;s multi_logloss: 0.19247
[131]	valid_0&#39;s multi_logloss: 0.191814
[132]	valid_0&#39;s multi_logloss: 0.19125
[133]	valid_0&#39;s multi_logloss: 0.190723
[134]	valid_0&#39;s multi_logloss: 0.190158
[135]	valid_0&#39;s multi_logloss: 0.189583
[136]	valid_0&#39;s multi_logloss: 0.188947
[137]	valid_0&#39;s multi_logloss: 0.188458
[138]	valid_0&#39;s multi_logloss: 0.187849
[139]	valid_0&#39;s multi_logloss: 0.187408
[140]	valid_0&#39;s multi_logloss: 0.18694
[141]	valid_0&#39;s multi_logloss: 0.186465
[142]	valid_0&#39;s multi_logloss: 0.185995
[143]	valid_0&#39;s multi_logloss: 0.185651
[144]	valid_0&#39;s multi_logloss: 0.185182
[145]	valid_0&#39;s multi_logloss: 0.184796
[146]	valid_0&#39;s multi_logloss: 0.184434
[147]	valid_0&#39;s multi_logloss: 0.183981
[148]	valid_0&#39;s multi_logloss: 0.183591
[149]	valid_0&#39;s multi_logloss: 0.183211
[150]	valid_0&#39;s multi_logloss: 0.182814
[151]	valid_0&#39;s multi_logloss: 0.182454
[152]	valid_0&#39;s multi_logloss: 0.18218
[153]	valid_0&#39;s multi_logloss: 0.181797
[154]	valid_0&#39;s multi_logloss: 0.181464
[155]	valid_0&#39;s multi_logloss: 0.181045
[156]	valid_0&#39;s multi_logloss: 0.180703
[157]	valid_0&#39;s multi_logloss: 0.180489
[158]	valid_0&#39;s multi_logloss: 0.180195
[159]	valid_0&#39;s multi_logloss: 0.179804
[160]	valid_0&#39;s multi_logloss: 0.179462
[161]	valid_0&#39;s multi_logloss: 0.179201
[162]	valid_0&#39;s multi_logloss: 0.178887
[163]	valid_0&#39;s multi_logloss: 0.178506
[164]	valid_0&#39;s multi_logloss: 0.178197
[165]	valid_0&#39;s multi_logloss: 0.177903
[166]	valid_0&#39;s multi_logloss: 0.177534
[167]	valid_0&#39;s multi_logloss: 0.177214
[168]	valid_0&#39;s multi_logloss: 0.176883
[169]	valid_0&#39;s multi_logloss: 0.176596
[170]	valid_0&#39;s multi_logloss: 0.176342
[171]	valid_0&#39;s multi_logloss: 0.176075
[172]	valid_0&#39;s multi_logloss: 0.17579
[173]	valid_0&#39;s multi_logloss: 0.175546
[174]	valid_0&#39;s multi_logloss: 0.175266
[175]	valid_0&#39;s multi_logloss: 0.175038
[176]	valid_0&#39;s multi_logloss: 0.174755
[177]	valid_0&#39;s multi_logloss: 0.174557
[178]	valid_0&#39;s multi_logloss: 0.174334
[179]	valid_0&#39;s multi_logloss: 0.174139
[180]	valid_0&#39;s multi_logloss: 0.173876
[181]	valid_0&#39;s multi_logloss: 0.173658
[182]	valid_0&#39;s multi_logloss: 0.17344
[183]	valid_0&#39;s multi_logloss: 0.173199
[184]	valid_0&#39;s multi_logloss: 0.172998
[185]	valid_0&#39;s multi_logloss: 0.172818
[186]	valid_0&#39;s multi_logloss: 0.172593
[187]	valid_0&#39;s multi_logloss: 0.172422
[188]	valid_0&#39;s multi_logloss: 0.172213
[189]	valid_0&#39;s multi_logloss: 0.17201
[190]	valid_0&#39;s multi_logloss: 0.171804
[191]	valid_0&#39;s multi_logloss: 0.171592
[192]	valid_0&#39;s multi_logloss: 0.171437
[193]	valid_0&#39;s multi_logloss: 0.171296
[194]	valid_0&#39;s multi_logloss: 0.171128
[195]	valid_0&#39;s multi_logloss: 0.170931
[196]	valid_0&#39;s multi_logloss: 0.170746
[197]	valid_0&#39;s multi_logloss: 0.170546
[198]	valid_0&#39;s multi_logloss: 0.170335
[199]	valid_0&#39;s multi_logloss: 0.170179
[200]	valid_0&#39;s multi_logloss: 0.170005
[201]	valid_0&#39;s multi_logloss: 0.169824
[202]	valid_0&#39;s multi_logloss: 0.1697
[203]	valid_0&#39;s multi_logloss: 0.169552
[204]	valid_0&#39;s multi_logloss: 0.169435
[205]	valid_0&#39;s multi_logloss: 0.169339
[206]	valid_0&#39;s multi_logloss: 0.169188
[207]	valid_0&#39;s multi_logloss: 0.169058
[208]	valid_0&#39;s multi_logloss: 0.16894
[209]	valid_0&#39;s multi_logloss: 0.168819
[210]	valid_0&#39;s multi_logloss: 0.168643
[211]	valid_0&#39;s multi_logloss: 0.16854
[212]	valid_0&#39;s multi_logloss: 0.168397
[213]	valid_0&#39;s multi_logloss: 0.168308
[214]	valid_0&#39;s multi_logloss: 0.168198
[215]	valid_0&#39;s multi_logloss: 0.168102
[216]	valid_0&#39;s multi_logloss: 0.167936
[217]	valid_0&#39;s multi_logloss: 0.167836
[218]	valid_0&#39;s multi_logloss: 0.167744
[219]	valid_0&#39;s multi_logloss: 0.167632
[220]	valid_0&#39;s multi_logloss: 0.167547
[221]	valid_0&#39;s multi_logloss: 0.167414
[222]	valid_0&#39;s multi_logloss: 0.167312
[223]	valid_0&#39;s multi_logloss: 0.167208
[224]	valid_0&#39;s multi_logloss: 0.167104
[225]	valid_0&#39;s multi_logloss: 0.166994
[226]	valid_0&#39;s multi_logloss: 0.166913
[227]	valid_0&#39;s multi_logloss: 0.166815
[228]	valid_0&#39;s multi_logloss: 0.166692
[229]	valid_0&#39;s multi_logloss: 0.16659
[230]	valid_0&#39;s multi_logloss: 0.166479
[231]	valid_0&#39;s multi_logloss: 0.166366
[232]	valid_0&#39;s multi_logloss: 0.166303
[233]	valid_0&#39;s multi_logloss: 0.166216
[234]	valid_0&#39;s multi_logloss: 0.166136
[235]	valid_0&#39;s multi_logloss: 0.166043
[236]	valid_0&#39;s multi_logloss: 0.165974
[237]	valid_0&#39;s multi_logloss: 0.165886
[238]	valid_0&#39;s multi_logloss: 0.165816
[239]	valid_0&#39;s multi_logloss: 0.165707
[240]	valid_0&#39;s multi_logloss: 0.165605
[241]	valid_0&#39;s multi_logloss: 0.165506
[242]	valid_0&#39;s multi_logloss: 0.16542
[243]	valid_0&#39;s multi_logloss: 0.165323
[244]	valid_0&#39;s multi_logloss: 0.16523
[245]	valid_0&#39;s multi_logloss: 0.165192
[246]	valid_0&#39;s multi_logloss: 0.165134
[247]	valid_0&#39;s multi_logloss: 0.165077
[248]	valid_0&#39;s multi_logloss: 0.165016
[249]	valid_0&#39;s multi_logloss: 0.164941
[250]	valid_0&#39;s multi_logloss: 0.164887
[251]	valid_0&#39;s multi_logloss: 0.164838
[252]	valid_0&#39;s multi_logloss: 0.164782
[253]	valid_0&#39;s multi_logloss: 0.164702
[254]	valid_0&#39;s multi_logloss: 0.164649
[255]	valid_0&#39;s multi_logloss: 0.164596
[256]	valid_0&#39;s multi_logloss: 0.164534
[257]	valid_0&#39;s multi_logloss: 0.164455
[258]	valid_0&#39;s multi_logloss: 0.164392
[259]	valid_0&#39;s multi_logloss: 0.16433
[260]	valid_0&#39;s multi_logloss: 0.164265
[261]	valid_0&#39;s multi_logloss: 0.164205
[262]	valid_0&#39;s multi_logloss: 0.164155
[263]	valid_0&#39;s multi_logloss: 0.164113
[264]	valid_0&#39;s multi_logloss: 0.16406
[265]	valid_0&#39;s multi_logloss: 0.16402
[266]	valid_0&#39;s multi_logloss: 0.163976
[267]	valid_0&#39;s multi_logloss: 0.163919
[268]	valid_0&#39;s multi_logloss: 0.163866
[269]	valid_0&#39;s multi_logloss: 0.163824
[270]	valid_0&#39;s multi_logloss: 0.163763
[271]	valid_0&#39;s multi_logloss: 0.163725
[272]	valid_0&#39;s multi_logloss: 0.16369
[273]	valid_0&#39;s multi_logloss: 0.163649
[274]	valid_0&#39;s multi_logloss: 0.163591
[275]	valid_0&#39;s multi_logloss: 0.163532
[276]	valid_0&#39;s multi_logloss: 0.163493
[277]	valid_0&#39;s multi_logloss: 0.163453
[278]	valid_0&#39;s multi_logloss: 0.163403
[279]	valid_0&#39;s multi_logloss: 0.163362
[280]	valid_0&#39;s multi_logloss: 0.163315
[281]	valid_0&#39;s multi_logloss: 0.16326
[282]	valid_0&#39;s multi_logloss: 0.163219
[283]	valid_0&#39;s multi_logloss: 0.163181
[284]	valid_0&#39;s multi_logloss: 0.163145
[285]	valid_0&#39;s multi_logloss: 0.163091
[286]	valid_0&#39;s multi_logloss: 0.163048
[287]	valid_0&#39;s multi_logloss: 0.163028
[288]	valid_0&#39;s multi_logloss: 0.162988
[289]	valid_0&#39;s multi_logloss: 0.162955
[290]	valid_0&#39;s multi_logloss: 0.16293
[291]	valid_0&#39;s multi_logloss: 0.162884
[292]	valid_0&#39;s multi_logloss: 0.162831
[293]	valid_0&#39;s multi_logloss: 0.162792
[294]	valid_0&#39;s multi_logloss: 0.162755
[295]	valid_0&#39;s multi_logloss: 0.162707
[296]	valid_0&#39;s multi_logloss: 0.162647
[297]	valid_0&#39;s multi_logloss: 0.162587
[298]	valid_0&#39;s multi_logloss: 0.16256
[299]	valid_0&#39;s multi_logloss: 0.162524
[300]	valid_0&#39;s multi_logloss: 0.162499
[301]	valid_0&#39;s multi_logloss: 0.162461
[302]	valid_0&#39;s multi_logloss: 0.162434
[303]	valid_0&#39;s multi_logloss: 0.16242
[304]	valid_0&#39;s multi_logloss: 0.1624
[305]	valid_0&#39;s multi_logloss: 0.162382
[306]	valid_0&#39;s multi_logloss: 0.162361
[307]	valid_0&#39;s multi_logloss: 0.162328
[308]	valid_0&#39;s multi_logloss: 0.162319
[309]	valid_0&#39;s multi_logloss: 0.162296
[310]	valid_0&#39;s multi_logloss: 0.162281
[311]	valid_0&#39;s multi_logloss: 0.162268
[312]	valid_0&#39;s multi_logloss: 0.162227
[313]	valid_0&#39;s multi_logloss: 0.162214
[314]	valid_0&#39;s multi_logloss: 0.162189
[315]	valid_0&#39;s multi_logloss: 0.162166
[316]	valid_0&#39;s multi_logloss: 0.162155
[317]	valid_0&#39;s multi_logloss: 0.162107
[318]	valid_0&#39;s multi_logloss: 0.162083
[319]	valid_0&#39;s multi_logloss: 0.162069
[320]	valid_0&#39;s multi_logloss: 0.162042
[321]	valid_0&#39;s multi_logloss: 0.162009
[322]	valid_0&#39;s multi_logloss: 0.161975
[323]	valid_0&#39;s multi_logloss: 0.161956
[324]	valid_0&#39;s multi_logloss: 0.161931
[325]	valid_0&#39;s multi_logloss: 0.161894
[326]	valid_0&#39;s multi_logloss: 0.161864
[327]	valid_0&#39;s multi_logloss: 0.161847
[328]	valid_0&#39;s multi_logloss: 0.161812
[329]	valid_0&#39;s multi_logloss: 0.161788
[330]	valid_0&#39;s multi_logloss: 0.161774
[331]	valid_0&#39;s multi_logloss: 0.16177
[332]	valid_0&#39;s multi_logloss: 0.161732
[333]	valid_0&#39;s multi_logloss: 0.161715
[334]	valid_0&#39;s multi_logloss: 0.161681
[335]	valid_0&#39;s multi_logloss: 0.161662
[336]	valid_0&#39;s multi_logloss: 0.161639
[337]	valid_0&#39;s multi_logloss: 0.161612
[338]	valid_0&#39;s multi_logloss: 0.161577
[339]	valid_0&#39;s multi_logloss: 0.161554
[340]	valid_0&#39;s multi_logloss: 0.161532
[341]	valid_0&#39;s multi_logloss: 0.161515
[342]	valid_0&#39;s multi_logloss: 0.161498
[343]	valid_0&#39;s multi_logloss: 0.161472
[344]	valid_0&#39;s multi_logloss: 0.161459
[345]	valid_0&#39;s multi_logloss: 0.161438
[346]	valid_0&#39;s multi_logloss: 0.16142
[347]	valid_0&#39;s multi_logloss: 0.161393
[348]	valid_0&#39;s multi_logloss: 0.161385
[349]	valid_0&#39;s multi_logloss: 0.161385
[350]	valid_0&#39;s multi_logloss: 0.161351
[351]	valid_0&#39;s multi_logloss: 0.161335
[352]	valid_0&#39;s multi_logloss: 0.161316
[353]	valid_0&#39;s multi_logloss: 0.161295
[354]	valid_0&#39;s multi_logloss: 0.161264
[355]	valid_0&#39;s multi_logloss: 0.161259
[356]	valid_0&#39;s multi_logloss: 0.161249
[357]	valid_0&#39;s multi_logloss: 0.161237
[358]	valid_0&#39;s multi_logloss: 0.161229
[359]	valid_0&#39;s multi_logloss: 0.161212
[360]	valid_0&#39;s multi_logloss: 0.161187
[361]	valid_0&#39;s multi_logloss: 0.161163
[362]	valid_0&#39;s multi_logloss: 0.161142
[363]	valid_0&#39;s multi_logloss: 0.161129
[364]	valid_0&#39;s multi_logloss: 0.161117
[365]	valid_0&#39;s multi_logloss: 0.161093
[366]	valid_0&#39;s multi_logloss: 0.161071
[367]	valid_0&#39;s multi_logloss: 0.161055
[368]	valid_0&#39;s multi_logloss: 0.161042
[369]	valid_0&#39;s multi_logloss: 0.161026
[370]	valid_0&#39;s multi_logloss: 0.161014
[371]	valid_0&#39;s multi_logloss: 0.161006
[372]	valid_0&#39;s multi_logloss: 0.160987
[373]	valid_0&#39;s multi_logloss: 0.160964
[374]	valid_0&#39;s multi_logloss: 0.160941
[375]	valid_0&#39;s multi_logloss: 0.160929
[376]	valid_0&#39;s multi_logloss: 0.160913
[377]	valid_0&#39;s multi_logloss: 0.160893
[378]	valid_0&#39;s multi_logloss: 0.160874
[379]	valid_0&#39;s multi_logloss: 0.160873
[380]	valid_0&#39;s multi_logloss: 0.160859
[381]	valid_0&#39;s multi_logloss: 0.160839
[382]	valid_0&#39;s multi_logloss: 0.160831
[383]	valid_0&#39;s multi_logloss: 0.160823
[384]	valid_0&#39;s multi_logloss: 0.160812
[385]	valid_0&#39;s multi_logloss: 0.160795
[386]	valid_0&#39;s multi_logloss: 0.160776
[387]	valid_0&#39;s multi_logloss: 0.16077
[388]	valid_0&#39;s multi_logloss: 0.160767
[389]	valid_0&#39;s multi_logloss: 0.160755
[390]	valid_0&#39;s multi_logloss: 0.160738
[391]	valid_0&#39;s multi_logloss: 0.16073
[392]	valid_0&#39;s multi_logloss: 0.160722
[393]	valid_0&#39;s multi_logloss: 0.160704
[394]	valid_0&#39;s multi_logloss: 0.160688
[395]	valid_0&#39;s multi_logloss: 0.160688
[396]	valid_0&#39;s multi_logloss: 0.16067
[397]	valid_0&#39;s multi_logloss: 0.160634
[398]	valid_0&#39;s multi_logloss: 0.160628
[399]	valid_0&#39;s multi_logloss: 0.160608
[400]	valid_0&#39;s multi_logloss: 0.160605
[401]	valid_0&#39;s multi_logloss: 0.160597
[402]	valid_0&#39;s multi_logloss: 0.160581
[403]	valid_0&#39;s multi_logloss: 0.160561
[404]	valid_0&#39;s multi_logloss: 0.16055
[405]	valid_0&#39;s multi_logloss: 0.160543
[406]	valid_0&#39;s multi_logloss: 0.160536
[407]	valid_0&#39;s multi_logloss: 0.16053
[408]	valid_0&#39;s multi_logloss: 0.16053
[409]	valid_0&#39;s multi_logloss: 0.160521
[410]	valid_0&#39;s multi_logloss: 0.160511
[411]	valid_0&#39;s multi_logloss: 0.160501
[412]	valid_0&#39;s multi_logloss: 0.16048
[413]	valid_0&#39;s multi_logloss: 0.160482
[414]	valid_0&#39;s multi_logloss: 0.16048
[415]	valid_0&#39;s multi_logloss: 0.160483
[416]	valid_0&#39;s multi_logloss: 0.160474
[417]	valid_0&#39;s multi_logloss: 0.160456
[418]	valid_0&#39;s multi_logloss: 0.160443
[419]	valid_0&#39;s multi_logloss: 0.160432
[420]	valid_0&#39;s multi_logloss: 0.160428
[421]	valid_0&#39;s multi_logloss: 0.160418
[422]	valid_0&#39;s multi_logloss: 0.160415
[423]	valid_0&#39;s multi_logloss: 0.160423
[424]	valid_0&#39;s multi_logloss: 0.160421
[425]	valid_0&#39;s multi_logloss: 0.160411
[426]	valid_0&#39;s multi_logloss: 0.160399
[427]	valid_0&#39;s multi_logloss: 0.160382
[428]	valid_0&#39;s multi_logloss: 0.160372
[429]	valid_0&#39;s multi_logloss: 0.160371
[430]	valid_0&#39;s multi_logloss: 0.160359
[431]	valid_0&#39;s multi_logloss: 0.160362
[432]	valid_0&#39;s multi_logloss: 0.160333
[433]	valid_0&#39;s multi_logloss: 0.160325
[434]	valid_0&#39;s multi_logloss: 0.160317
[435]	valid_0&#39;s multi_logloss: 0.160314
[436]	valid_0&#39;s multi_logloss: 0.160317
[437]	valid_0&#39;s multi_logloss: 0.160303
[438]	valid_0&#39;s multi_logloss: 0.160294
[439]	valid_0&#39;s multi_logloss: 0.160289
[440]	valid_0&#39;s multi_logloss: 0.160292
[441]	valid_0&#39;s multi_logloss: 0.160286
[442]	valid_0&#39;s multi_logloss: 0.160276
[443]	valid_0&#39;s multi_logloss: 0.16027
[444]	valid_0&#39;s multi_logloss: 0.160258
[445]	valid_0&#39;s multi_logloss: 0.160246
[446]	valid_0&#39;s multi_logloss: 0.160232
[447]	valid_0&#39;s multi_logloss: 0.160233
[448]	valid_0&#39;s multi_logloss: 0.16022
[449]	valid_0&#39;s multi_logloss: 0.16021
[450]	valid_0&#39;s multi_logloss: 0.16021
[451]	valid_0&#39;s multi_logloss: 0.160213
[452]	valid_0&#39;s multi_logloss: 0.160204
[453]	valid_0&#39;s multi_logloss: 0.160196
[454]	valid_0&#39;s multi_logloss: 0.160193
[455]	valid_0&#39;s multi_logloss: 0.160199
[456]	valid_0&#39;s multi_logloss: 0.160187
[457]	valid_0&#39;s multi_logloss: 0.160167
[458]	valid_0&#39;s multi_logloss: 0.160162
[459]	valid_0&#39;s multi_logloss: 0.160168
[460]	valid_0&#39;s multi_logloss: 0.160145
[461]	valid_0&#39;s multi_logloss: 0.160145
[462]	valid_0&#39;s multi_logloss: 0.160153
[463]	valid_0&#39;s multi_logloss: 0.160145
[464]	valid_0&#39;s multi_logloss: 0.160147
[465]	valid_0&#39;s multi_logloss: 0.16014
[466]	valid_0&#39;s multi_logloss: 0.160137
[467]	valid_0&#39;s multi_logloss: 0.160126
[468]	valid_0&#39;s multi_logloss: 0.160122
[469]	valid_0&#39;s multi_logloss: 0.160118
[470]	valid_0&#39;s multi_logloss: 0.160116
[471]	valid_0&#39;s multi_logloss: 0.16011
[472]	valid_0&#39;s multi_logloss: 0.160104
[473]	valid_0&#39;s multi_logloss: 0.160093
[474]	valid_0&#39;s multi_logloss: 0.160097
[475]	valid_0&#39;s multi_logloss: 0.160094
[476]	valid_0&#39;s multi_logloss: 0.160099
[477]	valid_0&#39;s multi_logloss: 0.160098
[478]	valid_0&#39;s multi_logloss: 0.160092
[479]	valid_0&#39;s multi_logloss: 0.160091
[480]	valid_0&#39;s multi_logloss: 0.160093
[481]	valid_0&#39;s multi_logloss: 0.160086
[482]	valid_0&#39;s multi_logloss: 0.160084
[483]	valid_0&#39;s multi_logloss: 0.160076
[484]	valid_0&#39;s multi_logloss: 0.160082
[485]	valid_0&#39;s multi_logloss: 0.160075
[486]	valid_0&#39;s multi_logloss: 0.160075
[487]	valid_0&#39;s multi_logloss: 0.160061
[488]	valid_0&#39;s multi_logloss: 0.160058
[489]	valid_0&#39;s multi_logloss: 0.160048
[490]	valid_0&#39;s multi_logloss: 0.160059
[491]	valid_0&#39;s multi_logloss: 0.160069
[492]	valid_0&#39;s multi_logloss: 0.160069
[493]	valid_0&#39;s multi_logloss: 0.160062
[494]	valid_0&#39;s multi_logloss: 0.160059
[495]	valid_0&#39;s multi_logloss: 0.160062
[496]	valid_0&#39;s multi_logloss: 0.160054
[497]	valid_0&#39;s multi_logloss: 0.160049
[498]	valid_0&#39;s multi_logloss: 0.160052
[499]	valid_0&#39;s multi_logloss: 0.160052
Early stopping, best iteration is:
[489]	valid_0&#39;s multi_logloss: 0.160048
training model for CV #3
[1]	valid_0&#39;s multi_logloss: 0.954266
Training until validation scores don&#39;t improve for 10 rounds
[2]	valid_0&#39;s multi_logloss: 0.924936
[3]	valid_0&#39;s multi_logloss: 0.895139
[4]	valid_0&#39;s multi_logloss: 0.867276
[5]	valid_0&#39;s multi_logloss: 0.840609
[6]	valid_0&#39;s multi_logloss: 0.817526
[7]	valid_0&#39;s multi_logloss: 0.794316
[8]	valid_0&#39;s multi_logloss: 0.773404
[9]	valid_0&#39;s multi_logloss: 0.754558
[10]	valid_0&#39;s multi_logloss: 0.733503
[11]	valid_0&#39;s multi_logloss: 0.713619
[12]	valid_0&#39;s multi_logloss: 0.694688
[13]	valid_0&#39;s multi_logloss: 0.676479
[14]	valid_0&#39;s multi_logloss: 0.658913
[15]	valid_0&#39;s multi_logloss: 0.642531
[16]	valid_0&#39;s multi_logloss: 0.62773
[17]	valid_0&#39;s multi_logloss: 0.612756
[18]	valid_0&#39;s multi_logloss: 0.598165
[19]	valid_0&#39;s multi_logloss: 0.584509
[20]	valid_0&#39;s multi_logloss: 0.572201
[21]	valid_0&#39;s multi_logloss: 0.559133
[22]	valid_0&#39;s multi_logloss: 0.546609
[23]	valid_0&#39;s multi_logloss: 0.534654
[24]	valid_0&#39;s multi_logloss: 0.524197
[25]	valid_0&#39;s multi_logloss: 0.513213
[26]	valid_0&#39;s multi_logloss: 0.50426
[27]	valid_0&#39;s multi_logloss: 0.494082
[28]	valid_0&#39;s multi_logloss: 0.484001
[29]	valid_0&#39;s multi_logloss: 0.475354
[30]	valid_0&#39;s multi_logloss: 0.466321
[31]	valid_0&#39;s multi_logloss: 0.458531
[32]	valid_0&#39;s multi_logloss: 0.450162
[33]	valid_0&#39;s multi_logloss: 0.441482
[34]	valid_0&#39;s multi_logloss: 0.433139
[35]	valid_0&#39;s multi_logloss: 0.425244
[36]	valid_0&#39;s multi_logloss: 0.418078
[37]	valid_0&#39;s multi_logloss: 0.411248
[38]	valid_0&#39;s multi_logloss: 0.404631
[39]	valid_0&#39;s multi_logloss: 0.3982
[40]	valid_0&#39;s multi_logloss: 0.391987
[41]	valid_0&#39;s multi_logloss: 0.385979
[42]	valid_0&#39;s multi_logloss: 0.38014
[43]	valid_0&#39;s multi_logloss: 0.37412
[44]	valid_0&#39;s multi_logloss: 0.369332
[45]	valid_0&#39;s multi_logloss: 0.364248
[46]	valid_0&#39;s multi_logloss: 0.35931
[47]	valid_0&#39;s multi_logloss: 0.354608
[48]	valid_0&#39;s multi_logloss: 0.349784
[49]	valid_0&#39;s multi_logloss: 0.344575
[50]	valid_0&#39;s multi_logloss: 0.340292
[51]	valid_0&#39;s multi_logloss: 0.335652
[52]	valid_0&#39;s multi_logloss: 0.331454
[53]	valid_0&#39;s multi_logloss: 0.327222
[54]	valid_0&#39;s multi_logloss: 0.323411
[55]	valid_0&#39;s multi_logloss: 0.319558
[56]	valid_0&#39;s multi_logloss: 0.316117
[57]	valid_0&#39;s multi_logloss: 0.312825
[58]	valid_0&#39;s multi_logloss: 0.309398
[59]	valid_0&#39;s multi_logloss: 0.305589
[60]	valid_0&#39;s multi_logloss: 0.302382
[61]	valid_0&#39;s multi_logloss: 0.298661
[62]	valid_0&#39;s multi_logloss: 0.295296
[63]	valid_0&#39;s multi_logloss: 0.292546
[64]	valid_0&#39;s multi_logloss: 0.289463
[65]	valid_0&#39;s multi_logloss: 0.286373
[66]	valid_0&#39;s multi_logloss: 0.283645
[67]	valid_0&#39;s multi_logloss: 0.28057
[68]	valid_0&#39;s multi_logloss: 0.277521
[69]	valid_0&#39;s multi_logloss: 0.275055
[70]	valid_0&#39;s multi_logloss: 0.272165
[71]	valid_0&#39;s multi_logloss: 0.269697
[72]	valid_0&#39;s multi_logloss: 0.267317
[73]	valid_0&#39;s multi_logloss: 0.265519
[74]	valid_0&#39;s multi_logloss: 0.263227
[75]	valid_0&#39;s multi_logloss: 0.260725
[76]	valid_0&#39;s multi_logloss: 0.258614
[77]	valid_0&#39;s multi_logloss: 0.256286
[78]	valid_0&#39;s multi_logloss: 0.254349
[79]	valid_0&#39;s multi_logloss: 0.25207
[80]	valid_0&#39;s multi_logloss: 0.250098
[81]	valid_0&#39;s multi_logloss: 0.248024
[82]	valid_0&#39;s multi_logloss: 0.245885
[83]	valid_0&#39;s multi_logloss: 0.243983
[84]	valid_0&#39;s multi_logloss: 0.242
[85]	valid_0&#39;s multi_logloss: 0.240021
[86]	valid_0&#39;s multi_logloss: 0.238143
[87]	valid_0&#39;s multi_logloss: 0.236583
[88]	valid_0&#39;s multi_logloss: 0.235164
[89]	valid_0&#39;s multi_logloss: 0.233479
[90]	valid_0&#39;s multi_logloss: 0.231854
[91]	valid_0&#39;s multi_logloss: 0.230227
[92]	valid_0&#39;s multi_logloss: 0.228844
[93]	valid_0&#39;s multi_logloss: 0.227417
[94]	valid_0&#39;s multi_logloss: 0.225867
[95]	valid_0&#39;s multi_logloss: 0.224507
[96]	valid_0&#39;s multi_logloss: 0.223123
[97]	valid_0&#39;s multi_logloss: 0.221807
[98]	valid_0&#39;s multi_logloss: 0.22038
[99]	valid_0&#39;s multi_logloss: 0.219168
[100]	valid_0&#39;s multi_logloss: 0.217908
[101]	valid_0&#39;s multi_logloss: 0.216779
[102]	valid_0&#39;s multi_logloss: 0.215675
[103]	valid_0&#39;s multi_logloss: 0.214431
[104]	valid_0&#39;s multi_logloss: 0.213388
[105]	valid_0&#39;s multi_logloss: 0.212257
[106]	valid_0&#39;s multi_logloss: 0.211264
[107]	valid_0&#39;s multi_logloss: 0.210495
[108]	valid_0&#39;s multi_logloss: 0.209359
[109]	valid_0&#39;s multi_logloss: 0.208354
[110]	valid_0&#39;s multi_logloss: 0.207519
[111]	valid_0&#39;s multi_logloss: 0.206722
[112]	valid_0&#39;s multi_logloss: 0.205968
[113]	valid_0&#39;s multi_logloss: 0.205027
[114]	valid_0&#39;s multi_logloss: 0.204238
[115]	valid_0&#39;s multi_logloss: 0.203296
[116]	valid_0&#39;s multi_logloss: 0.202397
[117]	valid_0&#39;s multi_logloss: 0.201475
[118]	valid_0&#39;s multi_logloss: 0.200795
[119]	valid_0&#39;s multi_logloss: 0.200209
[120]	valid_0&#39;s multi_logloss: 0.199363
[121]	valid_0&#39;s multi_logloss: 0.198794
[122]	valid_0&#39;s multi_logloss: 0.198155
[123]	valid_0&#39;s multi_logloss: 0.197407
[124]	valid_0&#39;s multi_logloss: 0.196754
[125]	valid_0&#39;s multi_logloss: 0.196054
[126]	valid_0&#39;s multi_logloss: 0.195542
[127]	valid_0&#39;s multi_logloss: 0.194944
[128]	valid_0&#39;s multi_logloss: 0.194308
[129]	valid_0&#39;s multi_logloss: 0.193734
[130]	valid_0&#39;s multi_logloss: 0.193106
[131]	valid_0&#39;s multi_logloss: 0.192472
[132]	valid_0&#39;s multi_logloss: 0.191918
[133]	valid_0&#39;s multi_logloss: 0.191398
[134]	valid_0&#39;s multi_logloss: 0.190854
[135]	valid_0&#39;s multi_logloss: 0.190271
[136]	valid_0&#39;s multi_logloss: 0.189633
[137]	valid_0&#39;s multi_logloss: 0.189135
[138]	valid_0&#39;s multi_logloss: 0.188523
[139]	valid_0&#39;s multi_logloss: 0.188078
[140]	valid_0&#39;s multi_logloss: 0.187593
[141]	valid_0&#39;s multi_logloss: 0.187113
[142]	valid_0&#39;s multi_logloss: 0.186671
[143]	valid_0&#39;s multi_logloss: 0.186318
[144]	valid_0&#39;s multi_logloss: 0.185856
[145]	valid_0&#39;s multi_logloss: 0.185468
[146]	valid_0&#39;s multi_logloss: 0.185134
[147]	valid_0&#39;s multi_logloss: 0.184678
[148]	valid_0&#39;s multi_logloss: 0.184291
[149]	valid_0&#39;s multi_logloss: 0.18391
[150]	valid_0&#39;s multi_logloss: 0.183549
[151]	valid_0&#39;s multi_logloss: 0.183223
[152]	valid_0&#39;s multi_logloss: 0.18294
[153]	valid_0&#39;s multi_logloss: 0.182569
[154]	valid_0&#39;s multi_logloss: 0.18223
[155]	valid_0&#39;s multi_logloss: 0.181809
[156]	valid_0&#39;s multi_logloss: 0.181463
[157]	valid_0&#39;s multi_logloss: 0.181255
[158]	valid_0&#39;s multi_logloss: 0.180925
[159]	valid_0&#39;s multi_logloss: 0.180541
[160]	valid_0&#39;s multi_logloss: 0.180191
[161]	valid_0&#39;s multi_logloss: 0.179921
[162]	valid_0&#39;s multi_logloss: 0.179594
[163]	valid_0&#39;s multi_logloss: 0.179222
[164]	valid_0&#39;s multi_logloss: 0.178893
[165]	valid_0&#39;s multi_logloss: 0.17859
[166]	valid_0&#39;s multi_logloss: 0.178218
[167]	valid_0&#39;s multi_logloss: 0.177889
[168]	valid_0&#39;s multi_logloss: 0.177572
[169]	valid_0&#39;s multi_logloss: 0.177257
[170]	valid_0&#39;s multi_logloss: 0.177001
[171]	valid_0&#39;s multi_logloss: 0.176754
[172]	valid_0&#39;s multi_logloss: 0.176466
[173]	valid_0&#39;s multi_logloss: 0.176227
[174]	valid_0&#39;s multi_logloss: 0.175945
[175]	valid_0&#39;s multi_logloss: 0.175701
[176]	valid_0&#39;s multi_logloss: 0.175401
[177]	valid_0&#39;s multi_logloss: 0.175183
[178]	valid_0&#39;s multi_logloss: 0.174971
[179]	valid_0&#39;s multi_logloss: 0.174788
[180]	valid_0&#39;s multi_logloss: 0.174552
[181]	valid_0&#39;s multi_logloss: 0.174324
[182]	valid_0&#39;s multi_logloss: 0.174104
[183]	valid_0&#39;s multi_logloss: 0.173869
[184]	valid_0&#39;s multi_logloss: 0.173671
[185]	valid_0&#39;s multi_logloss: 0.17349
[186]	valid_0&#39;s multi_logloss: 0.17325
[187]	valid_0&#39;s multi_logloss: 0.173095
[188]	valid_0&#39;s multi_logloss: 0.172865
[189]	valid_0&#39;s multi_logloss: 0.172645
[190]	valid_0&#39;s multi_logloss: 0.172455
[191]	valid_0&#39;s multi_logloss: 0.172241
[192]	valid_0&#39;s multi_logloss: 0.172084
[193]	valid_0&#39;s multi_logloss: 0.171947
[194]	valid_0&#39;s multi_logloss: 0.171784
[195]	valid_0&#39;s multi_logloss: 0.171577
[196]	valid_0&#39;s multi_logloss: 0.171403
[197]	valid_0&#39;s multi_logloss: 0.171217
[198]	valid_0&#39;s multi_logloss: 0.171047
[199]	valid_0&#39;s multi_logloss: 0.170889
[200]	valid_0&#39;s multi_logloss: 0.17071
[201]	valid_0&#39;s multi_logloss: 0.170549
[202]	valid_0&#39;s multi_logloss: 0.170431
[203]	valid_0&#39;s multi_logloss: 0.170303
[204]	valid_0&#39;s multi_logloss: 0.170181
[205]	valid_0&#39;s multi_logloss: 0.170089
[206]	valid_0&#39;s multi_logloss: 0.169925
[207]	valid_0&#39;s multi_logloss: 0.169806
[208]	valid_0&#39;s multi_logloss: 0.169696
[209]	valid_0&#39;s multi_logloss: 0.169555
[210]	valid_0&#39;s multi_logloss: 0.169397
[211]	valid_0&#39;s multi_logloss: 0.169288
[212]	valid_0&#39;s multi_logloss: 0.16917
[213]	valid_0&#39;s multi_logloss: 0.169086
[214]	valid_0&#39;s multi_logloss: 0.168978
[215]	valid_0&#39;s multi_logloss: 0.168874
[216]	valid_0&#39;s multi_logloss: 0.168724
[217]	valid_0&#39;s multi_logloss: 0.16863
[218]	valid_0&#39;s multi_logloss: 0.168537
[219]	valid_0&#39;s multi_logloss: 0.168403
[220]	valid_0&#39;s multi_logloss: 0.168293
[221]	valid_0&#39;s multi_logloss: 0.168143
[222]	valid_0&#39;s multi_logloss: 0.168068
[223]	valid_0&#39;s multi_logloss: 0.167962
[224]	valid_0&#39;s multi_logloss: 0.167856
[225]	valid_0&#39;s multi_logloss: 0.16775
[226]	valid_0&#39;s multi_logloss: 0.167649
[227]	valid_0&#39;s multi_logloss: 0.167568
[228]	valid_0&#39;s multi_logloss: 0.16746
[229]	valid_0&#39;s multi_logloss: 0.167354
[230]	valid_0&#39;s multi_logloss: 0.167221
[231]	valid_0&#39;s multi_logloss: 0.167103
[232]	valid_0&#39;s multi_logloss: 0.167009
[233]	valid_0&#39;s multi_logloss: 0.166936
[234]	valid_0&#39;s multi_logloss: 0.166853
[235]	valid_0&#39;s multi_logloss: 0.166757
[236]	valid_0&#39;s multi_logloss: 0.16668
[237]	valid_0&#39;s multi_logloss: 0.166582
[238]	valid_0&#39;s multi_logloss: 0.166519
[239]	valid_0&#39;s multi_logloss: 0.166405
[240]	valid_0&#39;s multi_logloss: 0.166328
[241]	valid_0&#39;s multi_logloss: 0.166262
[242]	valid_0&#39;s multi_logloss: 0.166205
[243]	valid_0&#39;s multi_logloss: 0.16613
[244]	valid_0&#39;s multi_logloss: 0.166036
[245]	valid_0&#39;s multi_logloss: 0.16601
[246]	valid_0&#39;s multi_logloss: 0.165949
[247]	valid_0&#39;s multi_logloss: 0.16591
[248]	valid_0&#39;s multi_logloss: 0.165847
[249]	valid_0&#39;s multi_logloss: 0.165775
[250]	valid_0&#39;s multi_logloss: 0.165717
[251]	valid_0&#39;s multi_logloss: 0.165655
[252]	valid_0&#39;s multi_logloss: 0.165593
[253]	valid_0&#39;s multi_logloss: 0.165544
[254]	valid_0&#39;s multi_logloss: 0.165497
[255]	valid_0&#39;s multi_logloss: 0.165438
[256]	valid_0&#39;s multi_logloss: 0.165386
[257]	valid_0&#39;s multi_logloss: 0.165308
[258]	valid_0&#39;s multi_logloss: 0.16524
[259]	valid_0&#39;s multi_logloss: 0.165175
[260]	valid_0&#39;s multi_logloss: 0.16511
[261]	valid_0&#39;s multi_logloss: 0.165056
[262]	valid_0&#39;s multi_logloss: 0.164999
[263]	valid_0&#39;s multi_logloss: 0.164932
[264]	valid_0&#39;s multi_logloss: 0.16485
[265]	valid_0&#39;s multi_logloss: 0.164809
[266]	valid_0&#39;s multi_logloss: 0.164743
[267]	valid_0&#39;s multi_logloss: 0.164693
[268]	valid_0&#39;s multi_logloss: 0.164642
[269]	valid_0&#39;s multi_logloss: 0.164599
[270]	valid_0&#39;s multi_logloss: 0.164514
[271]	valid_0&#39;s multi_logloss: 0.164481
[272]	valid_0&#39;s multi_logloss: 0.16444
[273]	valid_0&#39;s multi_logloss: 0.164392
[274]	valid_0&#39;s multi_logloss: 0.164333
[275]	valid_0&#39;s multi_logloss: 0.164272
[276]	valid_0&#39;s multi_logloss: 0.164224
[277]	valid_0&#39;s multi_logloss: 0.164174
[278]	valid_0&#39;s multi_logloss: 0.164131
[279]	valid_0&#39;s multi_logloss: 0.164073
[280]	valid_0&#39;s multi_logloss: 0.16404
[281]	valid_0&#39;s multi_logloss: 0.164012
[282]	valid_0&#39;s multi_logloss: 0.163975
[283]	valid_0&#39;s multi_logloss: 0.163927
[284]	valid_0&#39;s multi_logloss: 0.163881
[285]	valid_0&#39;s multi_logloss: 0.163845
[286]	valid_0&#39;s multi_logloss: 0.163798
[287]	valid_0&#39;s multi_logloss: 0.163776
[288]	valid_0&#39;s multi_logloss: 0.163752
[289]	valid_0&#39;s multi_logloss: 0.163708
[290]	valid_0&#39;s multi_logloss: 0.163673
[291]	valid_0&#39;s multi_logloss: 0.163635
[292]	valid_0&#39;s multi_logloss: 0.163606
[293]	valid_0&#39;s multi_logloss: 0.16357
[294]	valid_0&#39;s multi_logloss: 0.16354
[295]	valid_0&#39;s multi_logloss: 0.163493
[296]	valid_0&#39;s multi_logloss: 0.163465
[297]	valid_0&#39;s multi_logloss: 0.163419
[298]	valid_0&#39;s multi_logloss: 0.163379
[299]	valid_0&#39;s multi_logloss: 0.163344
[300]	valid_0&#39;s multi_logloss: 0.163314
[301]	valid_0&#39;s multi_logloss: 0.163286
[302]	valid_0&#39;s multi_logloss: 0.163257
[303]	valid_0&#39;s multi_logloss: 0.163234
[304]	valid_0&#39;s multi_logloss: 0.163208
[305]	valid_0&#39;s multi_logloss: 0.163163
[306]	valid_0&#39;s multi_logloss: 0.16315
[307]	valid_0&#39;s multi_logloss: 0.16313
[308]	valid_0&#39;s multi_logloss: 0.163113
[309]	valid_0&#39;s multi_logloss: 0.163093
[310]	valid_0&#39;s multi_logloss: 0.163084
[311]	valid_0&#39;s multi_logloss: 0.163057
[312]	valid_0&#39;s multi_logloss: 0.163017
[313]	valid_0&#39;s multi_logloss: 0.162978
[314]	valid_0&#39;s multi_logloss: 0.162949
[315]	valid_0&#39;s multi_logloss: 0.162913
[316]	valid_0&#39;s multi_logloss: 0.162894
[317]	valid_0&#39;s multi_logloss: 0.162864
[318]	valid_0&#39;s multi_logloss: 0.162854
[319]	valid_0&#39;s multi_logloss: 0.162832
[320]	valid_0&#39;s multi_logloss: 0.162806
[321]	valid_0&#39;s multi_logloss: 0.162767
[322]	valid_0&#39;s multi_logloss: 0.162752
[323]	valid_0&#39;s multi_logloss: 0.162725
[324]	valid_0&#39;s multi_logloss: 0.162703
[325]	valid_0&#39;s multi_logloss: 0.162672
[326]	valid_0&#39;s multi_logloss: 0.162644
[327]	valid_0&#39;s multi_logloss: 0.162617
[328]	valid_0&#39;s multi_logloss: 0.162584
[329]	valid_0&#39;s multi_logloss: 0.162558
[330]	valid_0&#39;s multi_logloss: 0.16254
[331]	valid_0&#39;s multi_logloss: 0.162517
[332]	valid_0&#39;s multi_logloss: 0.1625
[333]	valid_0&#39;s multi_logloss: 0.162479
[334]	valid_0&#39;s multi_logloss: 0.162452
[335]	valid_0&#39;s multi_logloss: 0.162436
[336]	valid_0&#39;s multi_logloss: 0.162417
[337]	valid_0&#39;s multi_logloss: 0.162394
[338]	valid_0&#39;s multi_logloss: 0.162375
[339]	valid_0&#39;s multi_logloss: 0.162352
[340]	valid_0&#39;s multi_logloss: 0.162334
[341]	valid_0&#39;s multi_logloss: 0.162321
[342]	valid_0&#39;s multi_logloss: 0.162312
[343]	valid_0&#39;s multi_logloss: 0.162304
[344]	valid_0&#39;s multi_logloss: 0.162295
[345]	valid_0&#39;s multi_logloss: 0.162286
[346]	valid_0&#39;s multi_logloss: 0.162249
[347]	valid_0&#39;s multi_logloss: 0.162237
[348]	valid_0&#39;s multi_logloss: 0.162198
[349]	valid_0&#39;s multi_logloss: 0.162179
[350]	valid_0&#39;s multi_logloss: 0.162158
[351]	valid_0&#39;s multi_logloss: 0.162122
[352]	valid_0&#39;s multi_logloss: 0.162114
[353]	valid_0&#39;s multi_logloss: 0.162098
[354]	valid_0&#39;s multi_logloss: 0.162091
[355]	valid_0&#39;s multi_logloss: 0.162071
[356]	valid_0&#39;s multi_logloss: 0.162066
[357]	valid_0&#39;s multi_logloss: 0.162048
[358]	valid_0&#39;s multi_logloss: 0.162037
[359]	valid_0&#39;s multi_logloss: 0.162028
[360]	valid_0&#39;s multi_logloss: 0.162016
[361]	valid_0&#39;s multi_logloss: 0.161995
[362]	valid_0&#39;s multi_logloss: 0.161986
[363]	valid_0&#39;s multi_logloss: 0.161974
[364]	valid_0&#39;s multi_logloss: 0.161965
[365]	valid_0&#39;s multi_logloss: 0.161955
[366]	valid_0&#39;s multi_logloss: 0.161946
[367]	valid_0&#39;s multi_logloss: 0.161937
[368]	valid_0&#39;s multi_logloss: 0.161917
[369]	valid_0&#39;s multi_logloss: 0.161907
[370]	valid_0&#39;s multi_logloss: 0.161907
[371]	valid_0&#39;s multi_logloss: 0.161903
[372]	valid_0&#39;s multi_logloss: 0.161883
[373]	valid_0&#39;s multi_logloss: 0.161861
[374]	valid_0&#39;s multi_logloss: 0.16184
[375]	valid_0&#39;s multi_logloss: 0.161815
[376]	valid_0&#39;s multi_logloss: 0.16179
[377]	valid_0&#39;s multi_logloss: 0.161792
[378]	valid_0&#39;s multi_logloss: 0.161776
[379]	valid_0&#39;s multi_logloss: 0.16177
[380]	valid_0&#39;s multi_logloss: 0.161768
[381]	valid_0&#39;s multi_logloss: 0.161764
[382]	valid_0&#39;s multi_logloss: 0.161751
[383]	valid_0&#39;s multi_logloss: 0.161754
[384]	valid_0&#39;s multi_logloss: 0.161753
[385]	valid_0&#39;s multi_logloss: 0.161759
[386]	valid_0&#39;s multi_logloss: 0.161747
[387]	valid_0&#39;s multi_logloss: 0.161721
[388]	valid_0&#39;s multi_logloss: 0.161695
[389]	valid_0&#39;s multi_logloss: 0.161673
[390]	valid_0&#39;s multi_logloss: 0.161662
[391]	valid_0&#39;s multi_logloss: 0.161645
[392]	valid_0&#39;s multi_logloss: 0.161632
[393]	valid_0&#39;s multi_logloss: 0.161617
[394]	valid_0&#39;s multi_logloss: 0.161609
[395]	valid_0&#39;s multi_logloss: 0.161591
[396]	valid_0&#39;s multi_logloss: 0.161577
[397]	valid_0&#39;s multi_logloss: 0.161566
[398]	valid_0&#39;s multi_logloss: 0.161549
[399]	valid_0&#39;s multi_logloss: 0.161542
[400]	valid_0&#39;s multi_logloss: 0.161538
[401]	valid_0&#39;s multi_logloss: 0.161531
[402]	valid_0&#39;s multi_logloss: 0.161508
[403]	valid_0&#39;s multi_logloss: 0.161502
[404]	valid_0&#39;s multi_logloss: 0.161503
[405]	valid_0&#39;s multi_logloss: 0.1615
[406]	valid_0&#39;s multi_logloss: 0.161495
[407]	valid_0&#39;s multi_logloss: 0.1615
[408]	valid_0&#39;s multi_logloss: 0.161495
[409]	valid_0&#39;s multi_logloss: 0.161489
[410]	valid_0&#39;s multi_logloss: 0.161482
[411]	valid_0&#39;s multi_logloss: 0.161474
[412]	valid_0&#39;s multi_logloss: 0.161465
[413]	valid_0&#39;s multi_logloss: 0.16145
[414]	valid_0&#39;s multi_logloss: 0.161427
[415]	valid_0&#39;s multi_logloss: 0.161424
[416]	valid_0&#39;s multi_logloss: 0.161418
[417]	valid_0&#39;s multi_logloss: 0.161406
[418]	valid_0&#39;s multi_logloss: 0.161379
[419]	valid_0&#39;s multi_logloss: 0.161368
[420]	valid_0&#39;s multi_logloss: 0.161372
[421]	valid_0&#39;s multi_logloss: 0.161348
[422]	valid_0&#39;s multi_logloss: 0.161338
[423]	valid_0&#39;s multi_logloss: 0.161334
[424]	valid_0&#39;s multi_logloss: 0.161326
[425]	valid_0&#39;s multi_logloss: 0.161332
[426]	valid_0&#39;s multi_logloss: 0.161319
[427]	valid_0&#39;s multi_logloss: 0.161315
[428]	valid_0&#39;s multi_logloss: 0.161306
[429]	valid_0&#39;s multi_logloss: 0.161292
[430]	valid_0&#39;s multi_logloss: 0.161291
[431]	valid_0&#39;s multi_logloss: 0.161286
[432]	valid_0&#39;s multi_logloss: 0.161284
[433]	valid_0&#39;s multi_logloss: 0.161276
[434]	valid_0&#39;s multi_logloss: 0.161277
[435]	valid_0&#39;s multi_logloss: 0.161273
[436]	valid_0&#39;s multi_logloss: 0.161267
[437]	valid_0&#39;s multi_logloss: 0.161261
[438]	valid_0&#39;s multi_logloss: 0.161254
[439]	valid_0&#39;s multi_logloss: 0.161231
[440]	valid_0&#39;s multi_logloss: 0.161227
[441]	valid_0&#39;s multi_logloss: 0.16123
[442]	valid_0&#39;s multi_logloss: 0.161226
[443]	valid_0&#39;s multi_logloss: 0.161208
[444]	valid_0&#39;s multi_logloss: 0.161189
[445]	valid_0&#39;s multi_logloss: 0.16119
[446]	valid_0&#39;s multi_logloss: 0.161184
[447]	valid_0&#39;s multi_logloss: 0.161173
[448]	valid_0&#39;s multi_logloss: 0.161175
[449]	valid_0&#39;s multi_logloss: 0.161161
[450]	valid_0&#39;s multi_logloss: 0.161157
[451]	valid_0&#39;s multi_logloss: 0.161163
[452]	valid_0&#39;s multi_logloss: 0.161166
[453]	valid_0&#39;s multi_logloss: 0.16116
[454]	valid_0&#39;s multi_logloss: 0.161166
[455]	valid_0&#39;s multi_logloss: 0.161163
[456]	valid_0&#39;s multi_logloss: 0.161169
[457]	valid_0&#39;s multi_logloss: 0.161171
[458]	valid_0&#39;s multi_logloss: 0.161164
[459]	valid_0&#39;s multi_logloss: 0.16117
[460]	valid_0&#39;s multi_logloss: 0.161166
Early stopping, best iteration is:
[450]	valid_0&#39;s multi_logloss: 0.161157
training model for CV #4
[1]	valid_0&#39;s multi_logloss: 0.954189
Training until validation scores don&#39;t improve for 10 rounds
[2]	valid_0&#39;s multi_logloss: 0.924709
[3]	valid_0&#39;s multi_logloss: 0.894819
[4]	valid_0&#39;s multi_logloss: 0.866771
[5]	valid_0&#39;s multi_logloss: 0.840116
[6]	valid_0&#39;s multi_logloss: 0.817088
[7]	valid_0&#39;s multi_logloss: 0.793985
[8]	valid_0&#39;s multi_logloss: 0.77324
[9]	valid_0&#39;s multi_logloss: 0.754335
[10]	valid_0&#39;s multi_logloss: 0.733415
[11]	valid_0&#39;s multi_logloss: 0.713528
[12]	valid_0&#39;s multi_logloss: 0.694498
[13]	valid_0&#39;s multi_logloss: 0.67631
[14]	valid_0&#39;s multi_logloss: 0.65865
[15]	valid_0&#39;s multi_logloss: 0.642275
[16]	valid_0&#39;s multi_logloss: 0.62741
[17]	valid_0&#39;s multi_logloss: 0.612429
[18]	valid_0&#39;s multi_logloss: 0.597863
[19]	valid_0&#39;s multi_logloss: 0.584319
[20]	valid_0&#39;s multi_logloss: 0.572051
[21]	valid_0&#39;s multi_logloss: 0.558968
[22]	valid_0&#39;s multi_logloss: 0.546362
[23]	valid_0&#39;s multi_logloss: 0.534446
[24]	valid_0&#39;s multi_logloss: 0.52397
[25]	valid_0&#39;s multi_logloss: 0.512993
[26]	valid_0&#39;s multi_logloss: 0.504106
[27]	valid_0&#39;s multi_logloss: 0.493937
[28]	valid_0&#39;s multi_logloss: 0.483846
[29]	valid_0&#39;s multi_logloss: 0.475204
[30]	valid_0&#39;s multi_logloss: 0.466174
[31]	valid_0&#39;s multi_logloss: 0.458364
[32]	valid_0&#39;s multi_logloss: 0.450026
[33]	valid_0&#39;s multi_logloss: 0.44134
[34]	valid_0&#39;s multi_logloss: 0.433006
[35]	valid_0&#39;s multi_logloss: 0.425141
[36]	valid_0&#39;s multi_logloss: 0.41783
[37]	valid_0&#39;s multi_logloss: 0.410987
[38]	valid_0&#39;s multi_logloss: 0.404354
[39]	valid_0&#39;s multi_logloss: 0.397885
[40]	valid_0&#39;s multi_logloss: 0.391674
[41]	valid_0&#39;s multi_logloss: 0.385638
[42]	valid_0&#39;s multi_logloss: 0.379782
[43]	valid_0&#39;s multi_logloss: 0.373743
[44]	valid_0&#39;s multi_logloss: 0.368906
[45]	valid_0&#39;s multi_logloss: 0.363829
[46]	valid_0&#39;s multi_logloss: 0.358891
[47]	valid_0&#39;s multi_logloss: 0.354212
[48]	valid_0&#39;s multi_logloss: 0.349384
[49]	valid_0&#39;s multi_logloss: 0.344243
[50]	valid_0&#39;s multi_logloss: 0.339962
[51]	valid_0&#39;s multi_logloss: 0.335293
[52]	valid_0&#39;s multi_logloss: 0.331076
[53]	valid_0&#39;s multi_logloss: 0.326821
[54]	valid_0&#39;s multi_logloss: 0.323022
[55]	valid_0&#39;s multi_logloss: 0.319151
[56]	valid_0&#39;s multi_logloss: 0.315738
[57]	valid_0&#39;s multi_logloss: 0.312414
[58]	valid_0&#39;s multi_logloss: 0.308976
[59]	valid_0&#39;s multi_logloss: 0.305214
[60]	valid_0&#39;s multi_logloss: 0.302045
[61]	valid_0&#39;s multi_logloss: 0.298325
[62]	valid_0&#39;s multi_logloss: 0.294983
[63]	valid_0&#39;s multi_logloss: 0.292264
[64]	valid_0&#39;s multi_logloss: 0.2892
[65]	valid_0&#39;s multi_logloss: 0.286127
[66]	valid_0&#39;s multi_logloss: 0.283405
[67]	valid_0&#39;s multi_logloss: 0.280333
[68]	valid_0&#39;s multi_logloss: 0.277269
[69]	valid_0&#39;s multi_logloss: 0.274808
[70]	valid_0&#39;s multi_logloss: 0.27191
[71]	valid_0&#39;s multi_logloss: 0.269506
[72]	valid_0&#39;s multi_logloss: 0.267119
[73]	valid_0&#39;s multi_logloss: 0.265347
[74]	valid_0&#39;s multi_logloss: 0.263062
[75]	valid_0&#39;s multi_logloss: 0.260553
[76]	valid_0&#39;s multi_logloss: 0.258513
[77]	valid_0&#39;s multi_logloss: 0.256173
[78]	valid_0&#39;s multi_logloss: 0.254255
[79]	valid_0&#39;s multi_logloss: 0.251976
[80]	valid_0&#39;s multi_logloss: 0.249988
[81]	valid_0&#39;s multi_logloss: 0.247897
[82]	valid_0&#39;s multi_logloss: 0.245758
[83]	valid_0&#39;s multi_logloss: 0.243877
[84]	valid_0&#39;s multi_logloss: 0.241876
[85]	valid_0&#39;s multi_logloss: 0.239892
[86]	valid_0&#39;s multi_logloss: 0.237985
[87]	valid_0&#39;s multi_logloss: 0.236413
[88]	valid_0&#39;s multi_logloss: 0.23502
[89]	valid_0&#39;s multi_logloss: 0.233399
[90]	valid_0&#39;s multi_logloss: 0.231801
[91]	valid_0&#39;s multi_logloss: 0.230173
[92]	valid_0&#39;s multi_logloss: 0.228809
[93]	valid_0&#39;s multi_logloss: 0.227394
[94]	valid_0&#39;s multi_logloss: 0.225921
[95]	valid_0&#39;s multi_logloss: 0.224586
[96]	valid_0&#39;s multi_logloss: 0.223169
[97]	valid_0&#39;s multi_logloss: 0.221879
[98]	valid_0&#39;s multi_logloss: 0.220502
[99]	valid_0&#39;s multi_logloss: 0.219262
[100]	valid_0&#39;s multi_logloss: 0.217985
[101]	valid_0&#39;s multi_logloss: 0.216887
[102]	valid_0&#39;s multi_logloss: 0.215753
[103]	valid_0&#39;s multi_logloss: 0.214501
[104]	valid_0&#39;s multi_logloss: 0.213435
[105]	valid_0&#39;s multi_logloss: 0.212332
[106]	valid_0&#39;s multi_logloss: 0.211329
[107]	valid_0&#39;s multi_logloss: 0.210541
[108]	valid_0&#39;s multi_logloss: 0.209394
[109]	valid_0&#39;s multi_logloss: 0.208401
[110]	valid_0&#39;s multi_logloss: 0.207612
[111]	valid_0&#39;s multi_logloss: 0.206832
[112]	valid_0&#39;s multi_logloss: 0.206084
[113]	valid_0&#39;s multi_logloss: 0.205136
[114]	valid_0&#39;s multi_logloss: 0.204377
[115]	valid_0&#39;s multi_logloss: 0.20344
[116]	valid_0&#39;s multi_logloss: 0.202559
[117]	valid_0&#39;s multi_logloss: 0.201662
[118]	valid_0&#39;s multi_logloss: 0.200966
[119]	valid_0&#39;s multi_logloss: 0.200379
[120]	valid_0&#39;s multi_logloss: 0.199538
[121]	valid_0&#39;s multi_logloss: 0.198951
[122]	valid_0&#39;s multi_logloss: 0.198338
[123]	valid_0&#39;s multi_logloss: 0.197588
[124]	valid_0&#39;s multi_logloss: 0.196953
[125]	valid_0&#39;s multi_logloss: 0.196269
[126]	valid_0&#39;s multi_logloss: 0.195728
[127]	valid_0&#39;s multi_logloss: 0.195136
[128]	valid_0&#39;s multi_logloss: 0.194506
[129]	valid_0&#39;s multi_logloss: 0.19394
[130]	valid_0&#39;s multi_logloss: 0.193311
[131]	valid_0&#39;s multi_logloss: 0.19269
[132]	valid_0&#39;s multi_logloss: 0.192124
[133]	valid_0&#39;s multi_logloss: 0.191604
[134]	valid_0&#39;s multi_logloss: 0.19106
[135]	valid_0&#39;s multi_logloss: 0.190493
[136]	valid_0&#39;s multi_logloss: 0.189892
[137]	valid_0&#39;s multi_logloss: 0.189395
[138]	valid_0&#39;s multi_logloss: 0.188786
[139]	valid_0&#39;s multi_logloss: 0.188364
[140]	valid_0&#39;s multi_logloss: 0.1879
[141]	valid_0&#39;s multi_logloss: 0.187462
[142]	valid_0&#39;s multi_logloss: 0.187023
[143]	valid_0&#39;s multi_logloss: 0.18668
[144]	valid_0&#39;s multi_logloss: 0.186197
[145]	valid_0&#39;s multi_logloss: 0.185797
[146]	valid_0&#39;s multi_logloss: 0.185459
[147]	valid_0&#39;s multi_logloss: 0.184992
[148]	valid_0&#39;s multi_logloss: 0.184611
[149]	valid_0&#39;s multi_logloss: 0.18422
[150]	valid_0&#39;s multi_logloss: 0.183863
[151]	valid_0&#39;s multi_logloss: 0.183496
[152]	valid_0&#39;s multi_logloss: 0.183231
[153]	valid_0&#39;s multi_logloss: 0.182855
[154]	valid_0&#39;s multi_logloss: 0.18253
[155]	valid_0&#39;s multi_logloss: 0.182101
[156]	valid_0&#39;s multi_logloss: 0.181763
[157]	valid_0&#39;s multi_logloss: 0.181562
[158]	valid_0&#39;s multi_logloss: 0.181213
[159]	valid_0&#39;s multi_logloss: 0.180805
[160]	valid_0&#39;s multi_logloss: 0.180475
[161]	valid_0&#39;s multi_logloss: 0.180214
[162]	valid_0&#39;s multi_logloss: 0.179894
[163]	valid_0&#39;s multi_logloss: 0.179522
[164]	valid_0&#39;s multi_logloss: 0.179209
[165]	valid_0&#39;s multi_logloss: 0.178904
[166]	valid_0&#39;s multi_logloss: 0.178545
[167]	valid_0&#39;s multi_logloss: 0.178223
[168]	valid_0&#39;s multi_logloss: 0.177913
[169]	valid_0&#39;s multi_logloss: 0.177585
[170]	valid_0&#39;s multi_logloss: 0.177332
[171]	valid_0&#39;s multi_logloss: 0.177032
[172]	valid_0&#39;s multi_logloss: 0.176723
[173]	valid_0&#39;s multi_logloss: 0.17647
[174]	valid_0&#39;s multi_logloss: 0.176181
[175]	valid_0&#39;s multi_logloss: 0.175946
[176]	valid_0&#39;s multi_logloss: 0.175673
[177]	valid_0&#39;s multi_logloss: 0.175458
[178]	valid_0&#39;s multi_logloss: 0.175235
[179]	valid_0&#39;s multi_logloss: 0.175049
[180]	valid_0&#39;s multi_logloss: 0.174812
[181]	valid_0&#39;s multi_logloss: 0.174595
[182]	valid_0&#39;s multi_logloss: 0.174374
[183]	valid_0&#39;s multi_logloss: 0.174125
[184]	valid_0&#39;s multi_logloss: 0.173943
[185]	valid_0&#39;s multi_logloss: 0.173739
[186]	valid_0&#39;s multi_logloss: 0.173502
[187]	valid_0&#39;s multi_logloss: 0.173329
[188]	valid_0&#39;s multi_logloss: 0.173135
[189]	valid_0&#39;s multi_logloss: 0.172902
[190]	valid_0&#39;s multi_logloss: 0.172691
[191]	valid_0&#39;s multi_logloss: 0.172475
[192]	valid_0&#39;s multi_logloss: 0.17233
[193]	valid_0&#39;s multi_logloss: 0.172178
[194]	valid_0&#39;s multi_logloss: 0.172011
[195]	valid_0&#39;s multi_logloss: 0.171808
[196]	valid_0&#39;s multi_logloss: 0.171647
[197]	valid_0&#39;s multi_logloss: 0.171438
[198]	valid_0&#39;s multi_logloss: 0.171258
[199]	valid_0&#39;s multi_logloss: 0.171101
[200]	valid_0&#39;s multi_logloss: 0.170928
[201]	valid_0&#39;s multi_logloss: 0.170762
[202]	valid_0&#39;s multi_logloss: 0.170659
[203]	valid_0&#39;s multi_logloss: 0.17051
[204]	valid_0&#39;s multi_logloss: 0.170386
[205]	valid_0&#39;s multi_logloss: 0.170299
[206]	valid_0&#39;s multi_logloss: 0.170123
[207]	valid_0&#39;s multi_logloss: 0.170011
[208]	valid_0&#39;s multi_logloss: 0.1699
[209]	valid_0&#39;s multi_logloss: 0.16974
[210]	valid_0&#39;s multi_logloss: 0.16958
[211]	valid_0&#39;s multi_logloss: 0.169506
[212]	valid_0&#39;s multi_logloss: 0.169359
[213]	valid_0&#39;s multi_logloss: 0.169267
[214]	valid_0&#39;s multi_logloss: 0.169156
[215]	valid_0&#39;s multi_logloss: 0.169032
[216]	valid_0&#39;s multi_logloss: 0.168879
[217]	valid_0&#39;s multi_logloss: 0.16877
[218]	valid_0&#39;s multi_logloss: 0.168685
[219]	valid_0&#39;s multi_logloss: 0.168579
[220]	valid_0&#39;s multi_logloss: 0.168479
[221]	valid_0&#39;s multi_logloss: 0.168353
[222]	valid_0&#39;s multi_logloss: 0.168263
[223]	valid_0&#39;s multi_logloss: 0.168146
[224]	valid_0&#39;s multi_logloss: 0.16804
[225]	valid_0&#39;s multi_logloss: 0.167907
[226]	valid_0&#39;s multi_logloss: 0.167848
[227]	valid_0&#39;s multi_logloss: 0.167765
[228]	valid_0&#39;s multi_logloss: 0.167662
[229]	valid_0&#39;s multi_logloss: 0.167557
[230]	valid_0&#39;s multi_logloss: 0.167462
[231]	valid_0&#39;s multi_logloss: 0.167358
[232]	valid_0&#39;s multi_logloss: 0.1673
[233]	valid_0&#39;s multi_logloss: 0.167224
[234]	valid_0&#39;s multi_logloss: 0.167117
[235]	valid_0&#39;s multi_logloss: 0.167027
[236]	valid_0&#39;s multi_logloss: 0.166948
[237]	valid_0&#39;s multi_logloss: 0.16687
[238]	valid_0&#39;s multi_logloss: 0.166811
[239]	valid_0&#39;s multi_logloss: 0.166704
[240]	valid_0&#39;s multi_logloss: 0.166626
[241]	valid_0&#39;s multi_logloss: 0.166544
[242]	valid_0&#39;s multi_logloss: 0.16648
[243]	valid_0&#39;s multi_logloss: 0.166389
[244]	valid_0&#39;s multi_logloss: 0.166296
[245]	valid_0&#39;s multi_logloss: 0.166255
[246]	valid_0&#39;s multi_logloss: 0.166207
[247]	valid_0&#39;s multi_logloss: 0.166147
[248]	valid_0&#39;s multi_logloss: 0.166082
[249]	valid_0&#39;s multi_logloss: 0.166008
[250]	valid_0&#39;s multi_logloss: 0.165943
[251]	valid_0&#39;s multi_logloss: 0.165886
[252]	valid_0&#39;s multi_logloss: 0.165834
[253]	valid_0&#39;s multi_logloss: 0.165767
[254]	valid_0&#39;s multi_logloss: 0.165711
[255]	valid_0&#39;s multi_logloss: 0.165643
[256]	valid_0&#39;s multi_logloss: 0.165589
[257]	valid_0&#39;s multi_logloss: 0.16549
[258]	valid_0&#39;s multi_logloss: 0.165431
[259]	valid_0&#39;s multi_logloss: 0.165366
[260]	valid_0&#39;s multi_logloss: 0.165285
[261]	valid_0&#39;s multi_logloss: 0.165228
[262]	valid_0&#39;s multi_logloss: 0.16517
[263]	valid_0&#39;s multi_logloss: 0.165127
[264]	valid_0&#39;s multi_logloss: 0.165073
[265]	valid_0&#39;s multi_logloss: 0.16503
[266]	valid_0&#39;s multi_logloss: 0.164981
[267]	valid_0&#39;s multi_logloss: 0.164933
[268]	valid_0&#39;s multi_logloss: 0.164885
[269]	valid_0&#39;s multi_logloss: 0.164836
[270]	valid_0&#39;s multi_logloss: 0.164774
[271]	valid_0&#39;s multi_logloss: 0.16473
[272]	valid_0&#39;s multi_logloss: 0.164668
[273]	valid_0&#39;s multi_logloss: 0.164627
[274]	valid_0&#39;s multi_logloss: 0.164571
[275]	valid_0&#39;s multi_logloss: 0.164511
[276]	valid_0&#39;s multi_logloss: 0.164467
[277]	valid_0&#39;s multi_logloss: 0.164425
[278]	valid_0&#39;s multi_logloss: 0.164382
[279]	valid_0&#39;s multi_logloss: 0.164348
[280]	valid_0&#39;s multi_logloss: 0.164295
[281]	valid_0&#39;s multi_logloss: 0.164259
[282]	valid_0&#39;s multi_logloss: 0.164229
[283]	valid_0&#39;s multi_logloss: 0.164178
[284]	valid_0&#39;s multi_logloss: 0.16413
[285]	valid_0&#39;s multi_logloss: 0.164071
[286]	valid_0&#39;s multi_logloss: 0.164044
[287]	valid_0&#39;s multi_logloss: 0.164016
[288]	valid_0&#39;s multi_logloss: 0.163988
[289]	valid_0&#39;s multi_logloss: 0.163941
[290]	valid_0&#39;s multi_logloss: 0.163906
[291]	valid_0&#39;s multi_logloss: 0.163877
[292]	valid_0&#39;s multi_logloss: 0.163838
[293]	valid_0&#39;s multi_logloss: 0.163812
[294]	valid_0&#39;s multi_logloss: 0.163758
[295]	valid_0&#39;s multi_logloss: 0.163703
[296]	valid_0&#39;s multi_logloss: 0.163652
[297]	valid_0&#39;s multi_logloss: 0.163608
[298]	valid_0&#39;s multi_logloss: 0.163576
[299]	valid_0&#39;s multi_logloss: 0.163541
[300]	valid_0&#39;s multi_logloss: 0.163513
[301]	valid_0&#39;s multi_logloss: 0.163486
[302]	valid_0&#39;s multi_logloss: 0.163471
[303]	valid_0&#39;s multi_logloss: 0.163435
[304]	valid_0&#39;s multi_logloss: 0.163398
[305]	valid_0&#39;s multi_logloss: 0.163364
[306]	valid_0&#39;s multi_logloss: 0.16333
[307]	valid_0&#39;s multi_logloss: 0.163292
[308]	valid_0&#39;s multi_logloss: 0.163276
[309]	valid_0&#39;s multi_logloss: 0.163245
[310]	valid_0&#39;s multi_logloss: 0.16324
[311]	valid_0&#39;s multi_logloss: 0.163204
[312]	valid_0&#39;s multi_logloss: 0.16318
[313]	valid_0&#39;s multi_logloss: 0.163164
[314]	valid_0&#39;s multi_logloss: 0.16313
[315]	valid_0&#39;s multi_logloss: 0.163108
[316]	valid_0&#39;s multi_logloss: 0.163087
[317]	valid_0&#39;s multi_logloss: 0.163053
[318]	valid_0&#39;s multi_logloss: 0.163017
[319]	valid_0&#39;s multi_logloss: 0.162989
[320]	valid_0&#39;s multi_logloss: 0.162972
[321]	valid_0&#39;s multi_logloss: 0.162948
[322]	valid_0&#39;s multi_logloss: 0.162911
[323]	valid_0&#39;s multi_logloss: 0.16288
[324]	valid_0&#39;s multi_logloss: 0.162877
[325]	valid_0&#39;s multi_logloss: 0.16285
[326]	valid_0&#39;s multi_logloss: 0.162833
[327]	valid_0&#39;s multi_logloss: 0.162807
[328]	valid_0&#39;s multi_logloss: 0.162788
[329]	valid_0&#39;s multi_logloss: 0.162769
[330]	valid_0&#39;s multi_logloss: 0.162752
[331]	valid_0&#39;s multi_logloss: 0.162739
[332]	valid_0&#39;s multi_logloss: 0.162719
[333]	valid_0&#39;s multi_logloss: 0.162693
[334]	valid_0&#39;s multi_logloss: 0.162675
[335]	valid_0&#39;s multi_logloss: 0.162668
[336]	valid_0&#39;s multi_logloss: 0.16264
[337]	valid_0&#39;s multi_logloss: 0.16262
[338]	valid_0&#39;s multi_logloss: 0.162606
[339]	valid_0&#39;s multi_logloss: 0.162595
[340]	valid_0&#39;s multi_logloss: 0.162583
[341]	valid_0&#39;s multi_logloss: 0.162561
[342]	valid_0&#39;s multi_logloss: 0.162551
[343]	valid_0&#39;s multi_logloss: 0.162529
[344]	valid_0&#39;s multi_logloss: 0.162507
[345]	valid_0&#39;s multi_logloss: 0.162478
[346]	valid_0&#39;s multi_logloss: 0.16246
[347]	valid_0&#39;s multi_logloss: 0.16244
[348]	valid_0&#39;s multi_logloss: 0.16242
[349]	valid_0&#39;s multi_logloss: 0.162417
[350]	valid_0&#39;s multi_logloss: 0.16241
[351]	valid_0&#39;s multi_logloss: 0.162389
[352]	valid_0&#39;s multi_logloss: 0.162362
[353]	valid_0&#39;s multi_logloss: 0.162339
[354]	valid_0&#39;s multi_logloss: 0.16233
[355]	valid_0&#39;s multi_logloss: 0.162295
[356]	valid_0&#39;s multi_logloss: 0.162282
[357]	valid_0&#39;s multi_logloss: 0.162263
[358]	valid_0&#39;s multi_logloss: 0.16226
[359]	valid_0&#39;s multi_logloss: 0.162249
[360]	valid_0&#39;s multi_logloss: 0.162228
[361]	valid_0&#39;s multi_logloss: 0.162211
[362]	valid_0&#39;s multi_logloss: 0.162205
[363]	valid_0&#39;s multi_logloss: 0.162207
[364]	valid_0&#39;s multi_logloss: 0.162198
[365]	valid_0&#39;s multi_logloss: 0.162186
[366]	valid_0&#39;s multi_logloss: 0.162183
[367]	valid_0&#39;s multi_logloss: 0.162167
[368]	valid_0&#39;s multi_logloss: 0.162151
[369]	valid_0&#39;s multi_logloss: 0.162132
[370]	valid_0&#39;s multi_logloss: 0.162118
[371]	valid_0&#39;s multi_logloss: 0.16211
[372]	valid_0&#39;s multi_logloss: 0.162102
[373]	valid_0&#39;s multi_logloss: 0.16208
[374]	valid_0&#39;s multi_logloss: 0.162067
[375]	valid_0&#39;s multi_logloss: 0.16206
[376]	valid_0&#39;s multi_logloss: 0.162058
[377]	valid_0&#39;s multi_logloss: 0.162034
[378]	valid_0&#39;s multi_logloss: 0.162042
[379]	valid_0&#39;s multi_logloss: 0.162036
[380]	valid_0&#39;s multi_logloss: 0.162018
[381]	valid_0&#39;s multi_logloss: 0.162022
[382]	valid_0&#39;s multi_logloss: 0.162009
[383]	valid_0&#39;s multi_logloss: 0.162001
[384]	valid_0&#39;s multi_logloss: 0.161985
[385]	valid_0&#39;s multi_logloss: 0.161977
[386]	valid_0&#39;s multi_logloss: 0.16196
[387]	valid_0&#39;s multi_logloss: 0.161939
[388]	valid_0&#39;s multi_logloss: 0.161936
[389]	valid_0&#39;s multi_logloss: 0.161934
[390]	valid_0&#39;s multi_logloss: 0.161913
[391]	valid_0&#39;s multi_logloss: 0.161886
[392]	valid_0&#39;s multi_logloss: 0.161877
[393]	valid_0&#39;s multi_logloss: 0.161868
[394]	valid_0&#39;s multi_logloss: 0.161859
[395]	valid_0&#39;s multi_logloss: 0.161858
[396]	valid_0&#39;s multi_logloss: 0.16185
[397]	valid_0&#39;s multi_logloss: 0.161822
[398]	valid_0&#39;s multi_logloss: 0.161816
[399]	valid_0&#39;s multi_logloss: 0.161809
[400]	valid_0&#39;s multi_logloss: 0.161807
[401]	valid_0&#39;s multi_logloss: 0.161796
[402]	valid_0&#39;s multi_logloss: 0.16179
[403]	valid_0&#39;s multi_logloss: 0.161779
[404]	valid_0&#39;s multi_logloss: 0.161777
[405]	valid_0&#39;s multi_logloss: 0.161775
[406]	valid_0&#39;s multi_logloss: 0.161752
[407]	valid_0&#39;s multi_logloss: 0.161756
[408]	valid_0&#39;s multi_logloss: 0.16175
[409]	valid_0&#39;s multi_logloss: 0.161737
[410]	valid_0&#39;s multi_logloss: 0.161723
[411]	valid_0&#39;s multi_logloss: 0.161719
[412]	valid_0&#39;s multi_logloss: 0.161722
[413]	valid_0&#39;s multi_logloss: 0.161715
[414]	valid_0&#39;s multi_logloss: 0.16171
[415]	valid_0&#39;s multi_logloss: 0.161716
[416]	valid_0&#39;s multi_logloss: 0.161714
[417]	valid_0&#39;s multi_logloss: 0.161718
[418]	valid_0&#39;s multi_logloss: 0.161718
[419]	valid_0&#39;s multi_logloss: 0.16171
[420]	valid_0&#39;s multi_logloss: 0.161704
[421]	valid_0&#39;s multi_logloss: 0.161686
[422]	valid_0&#39;s multi_logloss: 0.161669
[423]	valid_0&#39;s multi_logloss: 0.161663
[424]	valid_0&#39;s multi_logloss: 0.161663
[425]	valid_0&#39;s multi_logloss: 0.161654
[426]	valid_0&#39;s multi_logloss: 0.161655
[427]	valid_0&#39;s multi_logloss: 0.161651
[428]	valid_0&#39;s multi_logloss: 0.161638
[429]	valid_0&#39;s multi_logloss: 0.161632
[430]	valid_0&#39;s multi_logloss: 0.161629
[431]	valid_0&#39;s multi_logloss: 0.161617
[432]	valid_0&#39;s multi_logloss: 0.16162
[433]	valid_0&#39;s multi_logloss: 0.16161
[434]	valid_0&#39;s multi_logloss: 0.161605
[435]	valid_0&#39;s multi_logloss: 0.161601
[436]	valid_0&#39;s multi_logloss: 0.1616
[437]	valid_0&#39;s multi_logloss: 0.16159
[438]	valid_0&#39;s multi_logloss: 0.161587
[439]	valid_0&#39;s multi_logloss: 0.161584
[440]	valid_0&#39;s multi_logloss: 0.161582
[441]	valid_0&#39;s multi_logloss: 0.161562
[442]	valid_0&#39;s multi_logloss: 0.161545
[443]	valid_0&#39;s multi_logloss: 0.161547
[444]	valid_0&#39;s multi_logloss: 0.161542
[445]	valid_0&#39;s multi_logloss: 0.161542
[446]	valid_0&#39;s multi_logloss: 0.161545
[447]	valid_0&#39;s multi_logloss: 0.161539
[448]	valid_0&#39;s multi_logloss: 0.161543
[449]	valid_0&#39;s multi_logloss: 0.161543
[450]	valid_0&#39;s multi_logloss: 0.161535
[451]	valid_0&#39;s multi_logloss: 0.161532
[452]	valid_0&#39;s multi_logloss: 0.16152
[453]	valid_0&#39;s multi_logloss: 0.161519
[454]	valid_0&#39;s multi_logloss: 0.161512
[455]	valid_0&#39;s multi_logloss: 0.161501
[456]	valid_0&#39;s multi_logloss: 0.161491
[457]	valid_0&#39;s multi_logloss: 0.161485
[458]	valid_0&#39;s multi_logloss: 0.161487
[459]	valid_0&#39;s multi_logloss: 0.16148
[460]	valid_0&#39;s multi_logloss: 0.161478
[461]	valid_0&#39;s multi_logloss: 0.161472
[462]	valid_0&#39;s multi_logloss: 0.161473
[463]	valid_0&#39;s multi_logloss: 0.161472
[464]	valid_0&#39;s multi_logloss: 0.161472
[465]	valid_0&#39;s multi_logloss: 0.161469
[466]	valid_0&#39;s multi_logloss: 0.161463
[467]	valid_0&#39;s multi_logloss: 0.161458
[468]	valid_0&#39;s multi_logloss: 0.161454
[469]	valid_0&#39;s multi_logloss: 0.161453
[470]	valid_0&#39;s multi_logloss: 0.161448
[471]	valid_0&#39;s multi_logloss: 0.16144
[472]	valid_0&#39;s multi_logloss: 0.161432
[473]	valid_0&#39;s multi_logloss: 0.161438
[474]	valid_0&#39;s multi_logloss: 0.161434
[475]	valid_0&#39;s multi_logloss: 0.161429
[476]	valid_0&#39;s multi_logloss: 0.161427
[477]	valid_0&#39;s multi_logloss: 0.161433
[478]	valid_0&#39;s multi_logloss: 0.161435
[479]	valid_0&#39;s multi_logloss: 0.161423
[480]	valid_0&#39;s multi_logloss: 0.16143
[481]	valid_0&#39;s multi_logloss: 0.161429
[482]	valid_0&#39;s multi_logloss: 0.161419
[483]	valid_0&#39;s multi_logloss: 0.161412
[484]	valid_0&#39;s multi_logloss: 0.161417
[485]	valid_0&#39;s multi_logloss: 0.161412
[486]	valid_0&#39;s multi_logloss: 0.161405
[487]	valid_0&#39;s multi_logloss: 0.161417
[488]	valid_0&#39;s multi_logloss: 0.161408
[489]	valid_0&#39;s multi_logloss: 0.161392
[490]	valid_0&#39;s multi_logloss: 0.161397
[491]	valid_0&#39;s multi_logloss: 0.161397
[492]	valid_0&#39;s multi_logloss: 0.161391
[493]	valid_0&#39;s multi_logloss: 0.161382
[494]	valid_0&#39;s multi_logloss: 0.161381
[495]	valid_0&#39;s multi_logloss: 0.161384
[496]	valid_0&#39;s multi_logloss: 0.161376
[497]	valid_0&#39;s multi_logloss: 0.161372
[498]	valid_0&#39;s multi_logloss: 0.161367
[499]	valid_0&#39;s multi_logloss: 0.161367
[500]	valid_0&#39;s multi_logloss: 0.161365
[501]	valid_0&#39;s multi_logloss: 0.161369
[502]	valid_0&#39;s multi_logloss: 0.161372
[503]	valid_0&#39;s multi_logloss: 0.161366
[504]	valid_0&#39;s multi_logloss: 0.161369
[505]	valid_0&#39;s multi_logloss: 0.161351
[506]	valid_0&#39;s multi_logloss: 0.161343
[507]	valid_0&#39;s multi_logloss: 0.161351
[508]	valid_0&#39;s multi_logloss: 0.161342
[509]	valid_0&#39;s multi_logloss: 0.161336
[510]	valid_0&#39;s multi_logloss: 0.161339
[511]	valid_0&#39;s multi_logloss: 0.161336
[512]	valid_0&#39;s multi_logloss: 0.161327
[513]	valid_0&#39;s multi_logloss: 0.161329
[514]	valid_0&#39;s multi_logloss: 0.161331
[515]	valid_0&#39;s multi_logloss: 0.161331
[516]	valid_0&#39;s multi_logloss: 0.161327
[517]	valid_0&#39;s multi_logloss: 0.161324
[518]	valid_0&#39;s multi_logloss: 0.161317
[519]	valid_0&#39;s multi_logloss: 0.161312
[520]	valid_0&#39;s multi_logloss: 0.161317
[521]	valid_0&#39;s multi_logloss: 0.161316
[522]	valid_0&#39;s multi_logloss: 0.161308
[523]	valid_0&#39;s multi_logloss: 0.161301
[524]	valid_0&#39;s multi_logloss: 0.161292
[525]	valid_0&#39;s multi_logloss: 0.161296
[526]	valid_0&#39;s multi_logloss: 0.161292
[527]	valid_0&#39;s multi_logloss: 0.161291
[528]	valid_0&#39;s multi_logloss: 0.161297
[529]	valid_0&#39;s multi_logloss: 0.161298
[530]	valid_0&#39;s multi_logloss: 0.161307
[531]	valid_0&#39;s multi_logloss: 0.161296
[532]	valid_0&#39;s multi_logloss: 0.161306
[533]	valid_0&#39;s multi_logloss: 0.1613
[534]	valid_0&#39;s multi_logloss: 0.161299
[535]	valid_0&#39;s multi_logloss: 0.161286
[536]	valid_0&#39;s multi_logloss: 0.161286
[537]	valid_0&#39;s multi_logloss: 0.161282
[538]	valid_0&#39;s multi_logloss: 0.161273
[539]	valid_0&#39;s multi_logloss: 0.161272
[540]	valid_0&#39;s multi_logloss: 0.161274
[541]	valid_0&#39;s multi_logloss: 0.161281
[542]	valid_0&#39;s multi_logloss: 0.161281
[543]	valid_0&#39;s multi_logloss: 0.161282
[544]	valid_0&#39;s multi_logloss: 0.161278
[545]	valid_0&#39;s multi_logloss: 0.161273
[546]	valid_0&#39;s multi_logloss: 0.16127
[547]	valid_0&#39;s multi_logloss: 0.161279
[548]	valid_0&#39;s multi_logloss: 0.16128
[549]	valid_0&#39;s multi_logloss: 0.161286
[550]	valid_0&#39;s multi_logloss: 0.161284
[551]	valid_0&#39;s multi_logloss: 0.161298
[552]	valid_0&#39;s multi_logloss: 0.161297
[553]	valid_0&#39;s multi_logloss: 0.161299
[554]	valid_0&#39;s multi_logloss: 0.161289
[555]	valid_0&#39;s multi_logloss: 0.161293
[556]	valid_0&#39;s multi_logloss: 0.161285
Early stopping, best iteration is:
[546]	valid_0&#39;s multi_logloss: 0.16127
training model for CV #5
[1]	valid_0&#39;s multi_logloss: 0.954304
Training until validation scores don&#39;t improve for 10 rounds
[2]	valid_0&#39;s multi_logloss: 0.924878
[3]	valid_0&#39;s multi_logloss: 0.894901
[4]	valid_0&#39;s multi_logloss: 0.866955
[5]	valid_0&#39;s multi_logloss: 0.840236
[6]	valid_0&#39;s multi_logloss: 0.817127
[7]	valid_0&#39;s multi_logloss: 0.793998
[8]	valid_0&#39;s multi_logloss: 0.773214
[9]	valid_0&#39;s multi_logloss: 0.754359
[10]	valid_0&#39;s multi_logloss: 0.73335
[11]	valid_0&#39;s multi_logloss: 0.713449
[12]	valid_0&#39;s multi_logloss: 0.694452
[13]	valid_0&#39;s multi_logloss: 0.676126
[14]	valid_0&#39;s multi_logloss: 0.658562
[15]	valid_0&#39;s multi_logloss: 0.642079
[16]	valid_0&#39;s multi_logloss: 0.627225
[17]	valid_0&#39;s multi_logloss: 0.612276
[18]	valid_0&#39;s multi_logloss: 0.597721
[19]	valid_0&#39;s multi_logloss: 0.584077
[20]	valid_0&#39;s multi_logloss: 0.571632
[21]	valid_0&#39;s multi_logloss: 0.558593
[22]	valid_0&#39;s multi_logloss: 0.545987
[23]	valid_0&#39;s multi_logloss: 0.534032
[24]	valid_0&#39;s multi_logloss: 0.523546
[25]	valid_0&#39;s multi_logloss: 0.51256
[26]	valid_0&#39;s multi_logloss: 0.503683
[27]	valid_0&#39;s multi_logloss: 0.493512
[28]	valid_0&#39;s multi_logloss: 0.483305
[29]	valid_0&#39;s multi_logloss: 0.474697
[30]	valid_0&#39;s multi_logloss: 0.46564
[31]	valid_0&#39;s multi_logloss: 0.457829
[32]	valid_0&#39;s multi_logloss: 0.449476
[33]	valid_0&#39;s multi_logloss: 0.440822
[34]	valid_0&#39;s multi_logloss: 0.432529
[35]	valid_0&#39;s multi_logloss: 0.424637
[36]	valid_0&#39;s multi_logloss: 0.417437
[37]	valid_0&#39;s multi_logloss: 0.410601
[38]	valid_0&#39;s multi_logloss: 0.403977
[39]	valid_0&#39;s multi_logloss: 0.39755
[40]	valid_0&#39;s multi_logloss: 0.39134
[41]	valid_0&#39;s multi_logloss: 0.385308
[42]	valid_0&#39;s multi_logloss: 0.379451
[43]	valid_0&#39;s multi_logloss: 0.373503
[44]	valid_0&#39;s multi_logloss: 0.368619
[45]	valid_0&#39;s multi_logloss: 0.363466
[46]	valid_0&#39;s multi_logloss: 0.358546
[47]	valid_0&#39;s multi_logloss: 0.353759
[48]	valid_0&#39;s multi_logloss: 0.348934
[49]	valid_0&#39;s multi_logloss: 0.343782
[50]	valid_0&#39;s multi_logloss: 0.339517
[51]	valid_0&#39;s multi_logloss: 0.334837
[52]	valid_0&#39;s multi_logloss: 0.330646
[53]	valid_0&#39;s multi_logloss: 0.326413
[54]	valid_0&#39;s multi_logloss: 0.322597
[55]	valid_0&#39;s multi_logloss: 0.318762
[56]	valid_0&#39;s multi_logloss: 0.315299
[57]	valid_0&#39;s multi_logloss: 0.311966
[58]	valid_0&#39;s multi_logloss: 0.308558
[59]	valid_0&#39;s multi_logloss: 0.30475
[60]	valid_0&#39;s multi_logloss: 0.301579
[61]	valid_0&#39;s multi_logloss: 0.297931
[62]	valid_0&#39;s multi_logloss: 0.29462
[63]	valid_0&#39;s multi_logloss: 0.291888
[64]	valid_0&#39;s multi_logloss: 0.288803
[65]	valid_0&#39;s multi_logloss: 0.285699
[66]	valid_0&#39;s multi_logloss: 0.282943
[67]	valid_0&#39;s multi_logloss: 0.279868
[68]	valid_0&#39;s multi_logloss: 0.276805
[69]	valid_0&#39;s multi_logloss: 0.274304
[70]	valid_0&#39;s multi_logloss: 0.271467
[71]	valid_0&#39;s multi_logloss: 0.269041
[72]	valid_0&#39;s multi_logloss: 0.26664
[73]	valid_0&#39;s multi_logloss: 0.264853
[74]	valid_0&#39;s multi_logloss: 0.262581
[75]	valid_0&#39;s multi_logloss: 0.260055
[76]	valid_0&#39;s multi_logloss: 0.25797
[77]	valid_0&#39;s multi_logloss: 0.255619
[78]	valid_0&#39;s multi_logloss: 0.253683
[79]	valid_0&#39;s multi_logloss: 0.251404
[80]	valid_0&#39;s multi_logloss: 0.249424
[81]	valid_0&#39;s multi_logloss: 0.247311
[82]	valid_0&#39;s multi_logloss: 0.245169
[83]	valid_0&#39;s multi_logloss: 0.243308
[84]	valid_0&#39;s multi_logloss: 0.241302
[85]	valid_0&#39;s multi_logloss: 0.239294
[86]	valid_0&#39;s multi_logloss: 0.237374
[87]	valid_0&#39;s multi_logloss: 0.235782
[88]	valid_0&#39;s multi_logloss: 0.234365
[89]	valid_0&#39;s multi_logloss: 0.232709
[90]	valid_0&#39;s multi_logloss: 0.231068
[91]	valid_0&#39;s multi_logloss: 0.229469
[92]	valid_0&#39;s multi_logloss: 0.228109
[93]	valid_0&#39;s multi_logloss: 0.226676
[94]	valid_0&#39;s multi_logloss: 0.225163
[95]	valid_0&#39;s multi_logloss: 0.22377
[96]	valid_0&#39;s multi_logloss: 0.222339
[97]	valid_0&#39;s multi_logloss: 0.221035
[98]	valid_0&#39;s multi_logloss: 0.219617
[99]	valid_0&#39;s multi_logloss: 0.218392
[100]	valid_0&#39;s multi_logloss: 0.217122
[101]	valid_0&#39;s multi_logloss: 0.216014
[102]	valid_0&#39;s multi_logloss: 0.214903
[103]	valid_0&#39;s multi_logloss: 0.213664
[104]	valid_0&#39;s multi_logloss: 0.21262
[105]	valid_0&#39;s multi_logloss: 0.211526
[106]	valid_0&#39;s multi_logloss: 0.210532
[107]	valid_0&#39;s multi_logloss: 0.209785
[108]	valid_0&#39;s multi_logloss: 0.208645
[109]	valid_0&#39;s multi_logloss: 0.207631
[110]	valid_0&#39;s multi_logloss: 0.206837
[111]	valid_0&#39;s multi_logloss: 0.20605
[112]	valid_0&#39;s multi_logloss: 0.205302
[113]	valid_0&#39;s multi_logloss: 0.204346
[114]	valid_0&#39;s multi_logloss: 0.203591
[115]	valid_0&#39;s multi_logloss: 0.202693
[116]	valid_0&#39;s multi_logloss: 0.201813
[117]	valid_0&#39;s multi_logloss: 0.200866
[118]	valid_0&#39;s multi_logloss: 0.200163
[119]	valid_0&#39;s multi_logloss: 0.199571
[120]	valid_0&#39;s multi_logloss: 0.198734
[121]	valid_0&#39;s multi_logloss: 0.198128
[122]	valid_0&#39;s multi_logloss: 0.197518
[123]	valid_0&#39;s multi_logloss: 0.196752
[124]	valid_0&#39;s multi_logloss: 0.196079
[125]	valid_0&#39;s multi_logloss: 0.195386
[126]	valid_0&#39;s multi_logloss: 0.194888
[127]	valid_0&#39;s multi_logloss: 0.194301
[128]	valid_0&#39;s multi_logloss: 0.193648
[129]	valid_0&#39;s multi_logloss: 0.193091
[130]	valid_0&#39;s multi_logloss: 0.192407
[131]	valid_0&#39;s multi_logloss: 0.191761
[132]	valid_0&#39;s multi_logloss: 0.191176
[133]	valid_0&#39;s multi_logloss: 0.190657
[134]	valid_0&#39;s multi_logloss: 0.190109
[135]	valid_0&#39;s multi_logloss: 0.189532
[136]	valid_0&#39;s multi_logloss: 0.188888
[137]	valid_0&#39;s multi_logloss: 0.188407
[138]	valid_0&#39;s multi_logloss: 0.187798
[139]	valid_0&#39;s multi_logloss: 0.187351
[140]	valid_0&#39;s multi_logloss: 0.186887
[141]	valid_0&#39;s multi_logloss: 0.186422
[142]	valid_0&#39;s multi_logloss: 0.185965
[143]	valid_0&#39;s multi_logloss: 0.185635
[144]	valid_0&#39;s multi_logloss: 0.185171
[145]	valid_0&#39;s multi_logloss: 0.184769
[146]	valid_0&#39;s multi_logloss: 0.18442
[147]	valid_0&#39;s multi_logloss: 0.183925
[148]	valid_0&#39;s multi_logloss: 0.183532
[149]	valid_0&#39;s multi_logloss: 0.183142
[150]	valid_0&#39;s multi_logloss: 0.182756
[151]	valid_0&#39;s multi_logloss: 0.182406
[152]	valid_0&#39;s multi_logloss: 0.182116
[153]	valid_0&#39;s multi_logloss: 0.181752
[154]	valid_0&#39;s multi_logloss: 0.181437
[155]	valid_0&#39;s multi_logloss: 0.181018
[156]	valid_0&#39;s multi_logloss: 0.180706
[157]	valid_0&#39;s multi_logloss: 0.180496
[158]	valid_0&#39;s multi_logloss: 0.180189
[159]	valid_0&#39;s multi_logloss: 0.179785
[160]	valid_0&#39;s multi_logloss: 0.17944
[161]	valid_0&#39;s multi_logloss: 0.17918
[162]	valid_0&#39;s multi_logloss: 0.178872
[163]	valid_0&#39;s multi_logloss: 0.178498
[164]	valid_0&#39;s multi_logloss: 0.178174
[165]	valid_0&#39;s multi_logloss: 0.177876
[166]	valid_0&#39;s multi_logloss: 0.177536
[167]	valid_0&#39;s multi_logloss: 0.177214
[168]	valid_0&#39;s multi_logloss: 0.176905
[169]	valid_0&#39;s multi_logloss: 0.17656
[170]	valid_0&#39;s multi_logloss: 0.176335
[171]	valid_0&#39;s multi_logloss: 0.176081
[172]	valid_0&#39;s multi_logloss: 0.175786
[173]	valid_0&#39;s multi_logloss: 0.175534
[174]	valid_0&#39;s multi_logloss: 0.175244
[175]	valid_0&#39;s multi_logloss: 0.175024
[176]	valid_0&#39;s multi_logloss: 0.174747
[177]	valid_0&#39;s multi_logloss: 0.174535
[178]	valid_0&#39;s multi_logloss: 0.174323
[179]	valid_0&#39;s multi_logloss: 0.174142
[180]	valid_0&#39;s multi_logloss: 0.173904
[181]	valid_0&#39;s multi_logloss: 0.173675
[182]	valid_0&#39;s multi_logloss: 0.173442
[183]	valid_0&#39;s multi_logloss: 0.173186
[184]	valid_0&#39;s multi_logloss: 0.172988
[185]	valid_0&#39;s multi_logloss: 0.172802
[186]	valid_0&#39;s multi_logloss: 0.172559
[187]	valid_0&#39;s multi_logloss: 0.1724
[188]	valid_0&#39;s multi_logloss: 0.172175
[189]	valid_0&#39;s multi_logloss: 0.171961
[190]	valid_0&#39;s multi_logloss: 0.171774
[191]	valid_0&#39;s multi_logloss: 0.171565
[192]	valid_0&#39;s multi_logloss: 0.171406
[193]	valid_0&#39;s multi_logloss: 0.171269
[194]	valid_0&#39;s multi_logloss: 0.171088
[195]	valid_0&#39;s multi_logloss: 0.170902
[196]	valid_0&#39;s multi_logloss: 0.170726
[197]	valid_0&#39;s multi_logloss: 0.17052
[198]	valid_0&#39;s multi_logloss: 0.170357
[199]	valid_0&#39;s multi_logloss: 0.170211
[200]	valid_0&#39;s multi_logloss: 0.170019
[201]	valid_0&#39;s multi_logloss: 0.169849
[202]	valid_0&#39;s multi_logloss: 0.16972
[203]	valid_0&#39;s multi_logloss: 0.169606
[204]	valid_0&#39;s multi_logloss: 0.169483
[205]	valid_0&#39;s multi_logloss: 0.169388
[206]	valid_0&#39;s multi_logloss: 0.169202
[207]	valid_0&#39;s multi_logloss: 0.169089
[208]	valid_0&#39;s multi_logloss: 0.168986
[209]	valid_0&#39;s multi_logloss: 0.168826
[210]	valid_0&#39;s multi_logloss: 0.168683
[211]	valid_0&#39;s multi_logloss: 0.168591
[212]	valid_0&#39;s multi_logloss: 0.168458
[213]	valid_0&#39;s multi_logloss: 0.168374
[214]	valid_0&#39;s multi_logloss: 0.168255
[215]	valid_0&#39;s multi_logloss: 0.16816
[216]	valid_0&#39;s multi_logloss: 0.168018
[217]	valid_0&#39;s multi_logloss: 0.167909
[218]	valid_0&#39;s multi_logloss: 0.167829
[219]	valid_0&#39;s multi_logloss: 0.167727
[220]	valid_0&#39;s multi_logloss: 0.167617
[221]	valid_0&#39;s multi_logloss: 0.167476
[222]	valid_0&#39;s multi_logloss: 0.167397
[223]	valid_0&#39;s multi_logloss: 0.167287
[224]	valid_0&#39;s multi_logloss: 0.167184
[225]	valid_0&#39;s multi_logloss: 0.16706
[226]	valid_0&#39;s multi_logloss: 0.166976
[227]	valid_0&#39;s multi_logloss: 0.166918
[228]	valid_0&#39;s multi_logloss: 0.166827
[229]	valid_0&#39;s multi_logloss: 0.166737
[230]	valid_0&#39;s multi_logloss: 0.166627
[231]	valid_0&#39;s multi_logloss: 0.166508
[232]	valid_0&#39;s multi_logloss: 0.16642
[233]	valid_0&#39;s multi_logloss: 0.166335
[234]	valid_0&#39;s multi_logloss: 0.166242
[235]	valid_0&#39;s multi_logloss: 0.166135
[236]	valid_0&#39;s multi_logloss: 0.166056
[237]	valid_0&#39;s multi_logloss: 0.165971
[238]	valid_0&#39;s multi_logloss: 0.165913
[239]	valid_0&#39;s multi_logloss: 0.165813
[240]	valid_0&#39;s multi_logloss: 0.165729
[241]	valid_0&#39;s multi_logloss: 0.165649
[242]	valid_0&#39;s multi_logloss: 0.165553
[243]	valid_0&#39;s multi_logloss: 0.165464
[244]	valid_0&#39;s multi_logloss: 0.165388
[245]	valid_0&#39;s multi_logloss: 0.16534
[246]	valid_0&#39;s multi_logloss: 0.165284
[247]	valid_0&#39;s multi_logloss: 0.165237
[248]	valid_0&#39;s multi_logloss: 0.165155
[249]	valid_0&#39;s multi_logloss: 0.165089
[250]	valid_0&#39;s multi_logloss: 0.165023
[251]	valid_0&#39;s multi_logloss: 0.164961
[252]	valid_0&#39;s multi_logloss: 0.164895
[253]	valid_0&#39;s multi_logloss: 0.164837
[254]	valid_0&#39;s multi_logloss: 0.164778
[255]	valid_0&#39;s multi_logloss: 0.164718
[256]	valid_0&#39;s multi_logloss: 0.164671
[257]	valid_0&#39;s multi_logloss: 0.164604
[258]	valid_0&#39;s multi_logloss: 0.164531
[259]	valid_0&#39;s multi_logloss: 0.164479
[260]	valid_0&#39;s multi_logloss: 0.164416
[261]	valid_0&#39;s multi_logloss: 0.164344
[262]	valid_0&#39;s multi_logloss: 0.164282
[263]	valid_0&#39;s multi_logloss: 0.164202
[264]	valid_0&#39;s multi_logloss: 0.164151
[265]	valid_0&#39;s multi_logloss: 0.164094
[266]	valid_0&#39;s multi_logloss: 0.164041
[267]	valid_0&#39;s multi_logloss: 0.163981
[268]	valid_0&#39;s multi_logloss: 0.163939
[269]	valid_0&#39;s multi_logloss: 0.163892
[270]	valid_0&#39;s multi_logloss: 0.16383
[271]	valid_0&#39;s multi_logloss: 0.16381
[272]	valid_0&#39;s multi_logloss: 0.163768
[273]	valid_0&#39;s multi_logloss: 0.16372
[274]	valid_0&#39;s multi_logloss: 0.163669
[275]	valid_0&#39;s multi_logloss: 0.163612
[276]	valid_0&#39;s multi_logloss: 0.163567
[277]	valid_0&#39;s multi_logloss: 0.163508
[278]	valid_0&#39;s multi_logloss: 0.163459
[279]	valid_0&#39;s multi_logloss: 0.163387
[280]	valid_0&#39;s multi_logloss: 0.163362
[281]	valid_0&#39;s multi_logloss: 0.163328
[282]	valid_0&#39;s multi_logloss: 0.163278
[283]	valid_0&#39;s multi_logloss: 0.163233
[284]	valid_0&#39;s multi_logloss: 0.163186
[285]	valid_0&#39;s multi_logloss: 0.163148
[286]	valid_0&#39;s multi_logloss: 0.163115
[287]	valid_0&#39;s multi_logloss: 0.163075
[288]	valid_0&#39;s multi_logloss: 0.163023
[289]	valid_0&#39;s multi_logloss: 0.163008
[290]	valid_0&#39;s multi_logloss: 0.16297
[291]	valid_0&#39;s multi_logloss: 0.16293
[292]	valid_0&#39;s multi_logloss: 0.162891
[293]	valid_0&#39;s multi_logloss: 0.162843
[294]	valid_0&#39;s multi_logloss: 0.162797
[295]	valid_0&#39;s multi_logloss: 0.162732
[296]	valid_0&#39;s multi_logloss: 0.16269
[297]	valid_0&#39;s multi_logloss: 0.162636
[298]	valid_0&#39;s multi_logloss: 0.16258
[299]	valid_0&#39;s multi_logloss: 0.162525
[300]	valid_0&#39;s multi_logloss: 0.162496
[301]	valid_0&#39;s multi_logloss: 0.162454
[302]	valid_0&#39;s multi_logloss: 0.162436
[303]	valid_0&#39;s multi_logloss: 0.162391
[304]	valid_0&#39;s multi_logloss: 0.162346
[305]	valid_0&#39;s multi_logloss: 0.162321
[306]	valid_0&#39;s multi_logloss: 0.162299
[307]	valid_0&#39;s multi_logloss: 0.162263
[308]	valid_0&#39;s multi_logloss: 0.162253
[309]	valid_0&#39;s multi_logloss: 0.162216
[310]	valid_0&#39;s multi_logloss: 0.162202
[311]	valid_0&#39;s multi_logloss: 0.162186
[312]	valid_0&#39;s multi_logloss: 0.162151
[313]	valid_0&#39;s multi_logloss: 0.162121
[314]	valid_0&#39;s multi_logloss: 0.162102
[315]	valid_0&#39;s multi_logloss: 0.162066
[316]	valid_0&#39;s multi_logloss: 0.162047
[317]	valid_0&#39;s multi_logloss: 0.162021
[318]	valid_0&#39;s multi_logloss: 0.161996
[319]	valid_0&#39;s multi_logloss: 0.16195
[320]	valid_0&#39;s multi_logloss: 0.161911
[321]	valid_0&#39;s multi_logloss: 0.16187
[322]	valid_0&#39;s multi_logloss: 0.161845
[323]	valid_0&#39;s multi_logloss: 0.161826
[324]	valid_0&#39;s multi_logloss: 0.161808
[325]	valid_0&#39;s multi_logloss: 0.161784
[326]	valid_0&#39;s multi_logloss: 0.161761
[327]	valid_0&#39;s multi_logloss: 0.161741
[328]	valid_0&#39;s multi_logloss: 0.161718
[329]	valid_0&#39;s multi_logloss: 0.161681
[330]	valid_0&#39;s multi_logloss: 0.16168
[331]	valid_0&#39;s multi_logloss: 0.161661
[332]	valid_0&#39;s multi_logloss: 0.161631
[333]	valid_0&#39;s multi_logloss: 0.161614
[334]	valid_0&#39;s multi_logloss: 0.161586
[335]	valid_0&#39;s multi_logloss: 0.161567
[336]	valid_0&#39;s multi_logloss: 0.161552
[337]	valid_0&#39;s multi_logloss: 0.161536
[338]	valid_0&#39;s multi_logloss: 0.161521
[339]	valid_0&#39;s multi_logloss: 0.161512
[340]	valid_0&#39;s multi_logloss: 0.161514
[341]	valid_0&#39;s multi_logloss: 0.161513
[342]	valid_0&#39;s multi_logloss: 0.161505
[343]	valid_0&#39;s multi_logloss: 0.161483
[344]	valid_0&#39;s multi_logloss: 0.161461
[345]	valid_0&#39;s multi_logloss: 0.161442
[346]	valid_0&#39;s multi_logloss: 0.161422
[347]	valid_0&#39;s multi_logloss: 0.161393
[348]	valid_0&#39;s multi_logloss: 0.16137
[349]	valid_0&#39;s multi_logloss: 0.161367
[350]	valid_0&#39;s multi_logloss: 0.161349
[351]	valid_0&#39;s multi_logloss: 0.161329
[352]	valid_0&#39;s multi_logloss: 0.16132
[353]	valid_0&#39;s multi_logloss: 0.161292
[354]	valid_0&#39;s multi_logloss: 0.161277
[355]	valid_0&#39;s multi_logloss: 0.161269
[356]	valid_0&#39;s multi_logloss: 0.161258
[357]	valid_0&#39;s multi_logloss: 0.161246
[358]	valid_0&#39;s multi_logloss: 0.161232
[359]	valid_0&#39;s multi_logloss: 0.161222
[360]	valid_0&#39;s multi_logloss: 0.16122
[361]	valid_0&#39;s multi_logloss: 0.161206
[362]	valid_0&#39;s multi_logloss: 0.161184
[363]	valid_0&#39;s multi_logloss: 0.161176
[364]	valid_0&#39;s multi_logloss: 0.161171
[365]	valid_0&#39;s multi_logloss: 0.161143
[366]	valid_0&#39;s multi_logloss: 0.161124
[367]	valid_0&#39;s multi_logloss: 0.161104
[368]	valid_0&#39;s multi_logloss: 0.161074
[369]	valid_0&#39;s multi_logloss: 0.161041
[370]	valid_0&#39;s multi_logloss: 0.161044
[371]	valid_0&#39;s multi_logloss: 0.161034
[372]	valid_0&#39;s multi_logloss: 0.161018
[373]	valid_0&#39;s multi_logloss: 0.161011
[374]	valid_0&#39;s multi_logloss: 0.160997
[375]	valid_0&#39;s multi_logloss: 0.16098
[376]	valid_0&#39;s multi_logloss: 0.160952
[377]	valid_0&#39;s multi_logloss: 0.16094
[378]	valid_0&#39;s multi_logloss: 0.160926
[379]	valid_0&#39;s multi_logloss: 0.160923
[380]	valid_0&#39;s multi_logloss: 0.160902
[381]	valid_0&#39;s multi_logloss: 0.1609
[382]	valid_0&#39;s multi_logloss: 0.160886
[383]	valid_0&#39;s multi_logloss: 0.16087
[384]	valid_0&#39;s multi_logloss: 0.160868
[385]	valid_0&#39;s multi_logloss: 0.160855
[386]	valid_0&#39;s multi_logloss: 0.160838
[387]	valid_0&#39;s multi_logloss: 0.160831
[388]	valid_0&#39;s multi_logloss: 0.160806
[389]	valid_0&#39;s multi_logloss: 0.160798
[390]	valid_0&#39;s multi_logloss: 0.160783
[391]	valid_0&#39;s multi_logloss: 0.16078
[392]	valid_0&#39;s multi_logloss: 0.160756
[393]	valid_0&#39;s multi_logloss: 0.160733
[394]	valid_0&#39;s multi_logloss: 0.160704
[395]	valid_0&#39;s multi_logloss: 0.160692
[396]	valid_0&#39;s multi_logloss: 0.160676
[397]	valid_0&#39;s multi_logloss: 0.160672
[398]	valid_0&#39;s multi_logloss: 0.160662
[399]	valid_0&#39;s multi_logloss: 0.160655
[400]	valid_0&#39;s multi_logloss: 0.160655
[401]	valid_0&#39;s multi_logloss: 0.160646
[402]	valid_0&#39;s multi_logloss: 0.160635
[403]	valid_0&#39;s multi_logloss: 0.160615
[404]	valid_0&#39;s multi_logloss: 0.160601
[405]	valid_0&#39;s multi_logloss: 0.160585
[406]	valid_0&#39;s multi_logloss: 0.160589
[407]	valid_0&#39;s multi_logloss: 0.160582
[408]	valid_0&#39;s multi_logloss: 0.160582
[409]	valid_0&#39;s multi_logloss: 0.16057
[410]	valid_0&#39;s multi_logloss: 0.160555
[411]	valid_0&#39;s multi_logloss: 0.160553
[412]	valid_0&#39;s multi_logloss: 0.160546
[413]	valid_0&#39;s multi_logloss: 0.160541
[414]	valid_0&#39;s multi_logloss: 0.160536
[415]	valid_0&#39;s multi_logloss: 0.160527
[416]	valid_0&#39;s multi_logloss: 0.16053
[417]	valid_0&#39;s multi_logloss: 0.160504
[418]	valid_0&#39;s multi_logloss: 0.160503
[419]	valid_0&#39;s multi_logloss: 0.160473
[420]	valid_0&#39;s multi_logloss: 0.160467
[421]	valid_0&#39;s multi_logloss: 0.160458
[422]	valid_0&#39;s multi_logloss: 0.160448
[423]	valid_0&#39;s multi_logloss: 0.160422
[424]	valid_0&#39;s multi_logloss: 0.160418
[425]	valid_0&#39;s multi_logloss: 0.160423
[426]	valid_0&#39;s multi_logloss: 0.160412
[427]	valid_0&#39;s multi_logloss: 0.160413
[428]	valid_0&#39;s multi_logloss: 0.160413
[429]	valid_0&#39;s multi_logloss: 0.160411
[430]	valid_0&#39;s multi_logloss: 0.160406
[431]	valid_0&#39;s multi_logloss: 0.160391
[432]	valid_0&#39;s multi_logloss: 0.160393
[433]	valid_0&#39;s multi_logloss: 0.160383
[434]	valid_0&#39;s multi_logloss: 0.16038
[435]	valid_0&#39;s multi_logloss: 0.160366
[436]	valid_0&#39;s multi_logloss: 0.160362
[437]	valid_0&#39;s multi_logloss: 0.160365
[438]	valid_0&#39;s multi_logloss: 0.160353
[439]	valid_0&#39;s multi_logloss: 0.16035
[440]	valid_0&#39;s multi_logloss: 0.160338
[441]	valid_0&#39;s multi_logloss: 0.160333
[442]	valid_0&#39;s multi_logloss: 0.160325
[443]	valid_0&#39;s multi_logloss: 0.160316
[444]	valid_0&#39;s multi_logloss: 0.160318
[445]	valid_0&#39;s multi_logloss: 0.160323
[446]	valid_0&#39;s multi_logloss: 0.160325
[447]	valid_0&#39;s multi_logloss: 0.160322
[448]	valid_0&#39;s multi_logloss: 0.160306
[449]	valid_0&#39;s multi_logloss: 0.160303
[450]	valid_0&#39;s multi_logloss: 0.160288
[451]	valid_0&#39;s multi_logloss: 0.160277
[452]	valid_0&#39;s multi_logloss: 0.160281
[453]	valid_0&#39;s multi_logloss: 0.160273
[454]	valid_0&#39;s multi_logloss: 0.160278
[455]	valid_0&#39;s multi_logloss: 0.160277
[456]	valid_0&#39;s multi_logloss: 0.160276
[457]	valid_0&#39;s multi_logloss: 0.160282
[458]	valid_0&#39;s multi_logloss: 0.160276
[459]	valid_0&#39;s multi_logloss: 0.160272
[460]	valid_0&#39;s multi_logloss: 0.16027
[461]	valid_0&#39;s multi_logloss: 0.160266
[462]	valid_0&#39;s multi_logloss: 0.160265
[463]	valid_0&#39;s multi_logloss: 0.160254
[464]	valid_0&#39;s multi_logloss: 0.160247
[465]	valid_0&#39;s multi_logloss: 0.160237
[466]	valid_0&#39;s multi_logloss: 0.160213
[467]	valid_0&#39;s multi_logloss: 0.160199
[468]	valid_0&#39;s multi_logloss: 0.160192
[469]	valid_0&#39;s multi_logloss: 0.160181
[470]	valid_0&#39;s multi_logloss: 0.160176
[471]	valid_0&#39;s multi_logloss: 0.160172
[472]	valid_0&#39;s multi_logloss: 0.160152
[473]	valid_0&#39;s multi_logloss: 0.160157
[474]	valid_0&#39;s multi_logloss: 0.160163
[475]	valid_0&#39;s multi_logloss: 0.160149
[476]	valid_0&#39;s multi_logloss: 0.160137
[477]	valid_0&#39;s multi_logloss: 0.160122
[478]	valid_0&#39;s multi_logloss: 0.160106
[479]	valid_0&#39;s multi_logloss: 0.160094
[480]	valid_0&#39;s multi_logloss: 0.160095
[481]	valid_0&#39;s multi_logloss: 0.160095
[482]	valid_0&#39;s multi_logloss: 0.16009
[483]	valid_0&#39;s multi_logloss: 0.160081
[484]	valid_0&#39;s multi_logloss: 0.160088
[485]	valid_0&#39;s multi_logloss: 0.160091
[486]	valid_0&#39;s multi_logloss: 0.160087
[487]	valid_0&#39;s multi_logloss: 0.160073
[488]	valid_0&#39;s multi_logloss: 0.16008
[489]	valid_0&#39;s multi_logloss: 0.160088
[490]	valid_0&#39;s multi_logloss: 0.160079
[491]	valid_0&#39;s multi_logloss: 0.160076
[492]	valid_0&#39;s multi_logloss: 0.160077
[493]	valid_0&#39;s multi_logloss: 0.160075
[494]	valid_0&#39;s multi_logloss: 0.160079
[495]	valid_0&#39;s multi_logloss: 0.160081
[496]	valid_0&#39;s multi_logloss: 0.160077
[497]	valid_0&#39;s multi_logloss: 0.160074
Early stopping, best iteration is:
[487]	valid_0&#39;s multi_logloss: 0.160073
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">p_val</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>93.2728%
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">p_val</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">p_tst</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(320000, 3) (80000, 3)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">p_val_file</span><span class="p">,</span> <span class="n">p_val</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%.6f</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">p_tst_file</span><span class="p">,</span> <span class="n">p_tst</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%.6f</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id3">
<h2>피처 중요도 시각화<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">imp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;feature&#39;</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="s1">&#39;importance&#39;</span><span class="p">:</span> <span class="n">clf</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">})</span>
<span class="n">imp</span> <span class="o">=</span> <span class="n">imp</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;importance&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;feature&#39;</span><span class="p">)</span>
<span class="n">imp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;barh&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f8040bbac90&gt;
</pre></div>
</div>
<img alt="../_images/09-lightgbm-hyperopt_24_1.png" src="../_images/09-lightgbm-hyperopt_24_1.png" />
</div>
</div>
</div>
<div class="section" id="id4">
<h2>제출 파일 생성<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sub</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">sample_file</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sub</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">sub</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(80000, 1)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>class</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>320000</th>
      <td>0</td>
    </tr>
    <tr>
      <th>320001</th>
      <td>0</td>
    </tr>
    <tr>
      <th>320002</th>
      <td>0</td>
    </tr>
    <tr>
      <th>320003</th>
      <td>0</td>
    </tr>
    <tr>
      <th>320004</th>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sub</span><span class="p">[</span><span class="n">target_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">p_tst</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">sub</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>class</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>320000</th>
      <td>2</td>
    </tr>
    <tr>
      <th>320001</th>
      <td>0</td>
    </tr>
    <tr>
      <th>320002</th>
      <td>2</td>
    </tr>
    <tr>
      <th>320003</th>
      <td>0</td>
    </tr>
    <tr>
      <th>320004</th>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sub</span><span class="p">[</span><span class="n">target_col</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2    41076
0    29965
1     8959
Name: class, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sub</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">sub_file</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./lectures"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="09-tuning.html" title="previous page">9. 모델 튜닝</a>
    <a class='right-next' id="next-link" href="09-lightgbm-optuna.html" title="next page">데모</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Kaggler-TV<br/>
        
            &copy; Copyright 2020-.<br/>
          <div class="extra_footer">
            <div class="row_footer"> Website organized by <a href="https://github.com/SDSTony">Sungjin Ahn</a> </div>
          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>